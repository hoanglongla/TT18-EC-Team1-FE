{"ast":null,"code":"// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @externs_url https://raw.githubusercontent.com/google/closure-compiler/master/contrib/externs/maps/google_maps_api_v3_16.js\n// ==/ClosureCompiler==\n\n/**\n * @name CSS3 InfoBubble with tabs for Google Maps API V3\n * @version 0.8\n * @author Luke Mahe\n * @fileoverview\n * This library is a CSS Infobubble with tabs. It uses css3 rounded corners and\n * drop shadows and animations. It also allows tabs\n */\n\n/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A CSS3 InfoBubble v0.8\n * @param {Object.<string, *>=} opt_options Optional properties to set.\n * @extends {google.maps.OverlayView}\n * @constructor\n */\nfunction InfoBubble(opt_options) {\n  this.extend(InfoBubble, google.maps.OverlayView);\n  this.tabs_ = [];\n  this.activeTab_ = null;\n  this.baseZIndex_ = 100;\n  this.isOpen_ = false;\n  var options = opt_options || {};\n\n  if (options['backgroundColor'] == undefined) {\n    options['backgroundColor'] = this.BACKGROUND_COLOR_;\n  }\n\n  if (options['borderColor'] == undefined) {\n    options['borderColor'] = this.BORDER_COLOR_;\n  }\n\n  if (options['borderRadius'] == undefined) {\n    options['borderRadius'] = this.BORDER_RADIUS_;\n  }\n\n  if (options['borderWidth'] == undefined) {\n    options['borderWidth'] = this.BORDER_WIDTH_;\n  }\n\n  if (options['padding'] == undefined) {\n    options['padding'] = this.PADDING_;\n  }\n\n  if (options['arrowPosition'] == undefined) {\n    options['arrowPosition'] = this.ARROW_POSITION_;\n  }\n\n  if (options['disableAutoPan'] == undefined) {\n    options['disableAutoPan'] = false;\n  }\n\n  if (options['disableAnimation'] == undefined) {\n    options['disableAnimation'] = false;\n  }\n\n  if (options['minWidth'] == undefined) {\n    options['minWidth'] = this.MIN_WIDTH_;\n  }\n\n  if (options['shadowStyle'] == undefined) {\n    options['shadowStyle'] = this.SHADOW_STYLE_;\n  }\n\n  if (options['arrowSize'] == undefined) {\n    options['arrowSize'] = this.ARROW_SIZE_;\n  }\n\n  if (options['arrowStyle'] == undefined) {\n    options['arrowStyle'] = this.ARROW_STYLE_;\n  }\n\n  if (options['closeSrc'] == undefined) {\n    options['closeSrc'] = this.CLOSE_SRC_;\n  }\n\n  this.buildDom_();\n  this.setValues(options);\n}\n\nwindow['InfoBubble'] = InfoBubble;\n/**\n * Default arrow size\n * @const\n * @private\n */\n\nInfoBubble.prototype.ARROW_SIZE_ = 15;\n/**\n * Default arrow style\n * @const\n * @private\n */\n\nInfoBubble.prototype.ARROW_STYLE_ = 0;\n/**\n * Default shadow style\n * @const\n * @private\n */\n\nInfoBubble.prototype.SHADOW_STYLE_ = 1;\n/**\n * Default min width\n * @const\n * @private\n */\n\nInfoBubble.prototype.MIN_WIDTH_ = 50;\n/**\n * Default arrow position\n * @const\n * @private\n */\n\nInfoBubble.prototype.ARROW_POSITION_ = 50;\n/**\n * Default padding\n * @const\n * @private\n */\n\nInfoBubble.prototype.PADDING_ = 10;\n/**\n * Default border width\n * @const\n * @private\n */\n\nInfoBubble.prototype.BORDER_WIDTH_ = 1;\n/**\n * Default border color\n * @const\n * @private\n */\n\nInfoBubble.prototype.BORDER_COLOR_ = '#ccc';\n/**\n * Default border radius\n * @const\n * @private\n */\n\nInfoBubble.prototype.BORDER_RADIUS_ = 10;\n/**\n * Default background color\n * @const\n * @private\n */\n\nInfoBubble.prototype.BACKGROUND_COLOR_ = '#fff';\n/**\n * Default close image source\n * @const\n * @private\n */\n\nInfoBubble.prototype.CLOSE_SRC_ = 'https://maps.gstatic.com/intl/en_us/mapfiles/iw_close.gif';\n/**\n * Extends a objects prototype by anothers.\n *\n * @param {Object} obj1 The object to be extended.\n * @param {Object} obj2 The object to extend with.\n * @return {Object} The new extended object.\n * @ignore\n */\n\nInfoBubble.prototype.extend = function (obj1, obj2) {\n  return function (object) {\n    for (var property in object.prototype) {\n      this.prototype[property] = object.prototype[property];\n    }\n\n    return this;\n  }.apply(obj1, [obj2]);\n};\n/**\n * Builds the InfoBubble dom\n * @private\n */\n\n\nInfoBubble.prototype.buildDom_ = function () {\n  var bubble = this.bubble_ = document.createElement('DIV');\n  bubble.style['position'] = 'absolute';\n  bubble.style['zIndex'] = this.baseZIndex_;\n  var tabsContainer = this.tabsContainer_ = document.createElement('DIV');\n  tabsContainer.style['position'] = 'relative'; // Close button\n\n  var close = this.close_ = document.createElement('IMG');\n  close.style['position'] = 'absolute';\n  close.style['border'] = 0;\n  close.style['zIndex'] = this.baseZIndex_ + 1;\n  close.style['cursor'] = 'pointer';\n  close.className = 'js-info-bubble-close';\n  close.src = this.get('closeSrc');\n  var that = this;\n  google.maps.event.addDomListener(close, 'click', function () {\n    that.close();\n    google.maps.event.trigger(that, 'closeclick');\n  }); // Content area\n\n  var contentContainer = this.contentContainer_ = document.createElement('DIV');\n  contentContainer.style['overflowX'] = 'auto';\n  contentContainer.style['overflowY'] = 'auto';\n  contentContainer.style['cursor'] = 'default';\n  contentContainer.style['clear'] = 'both';\n  contentContainer.style['position'] = 'relative';\n  var content = this.content_ = document.createElement('DIV');\n  contentContainer.appendChild(content); // Arrow\n\n  var arrow = this.arrow_ = document.createElement('DIV');\n  arrow.style['position'] = 'relative';\n  var arrowOuter = this.arrowOuter_ = document.createElement('DIV');\n  var arrowInner = this.arrowInner_ = document.createElement('DIV');\n  var arrowSize = this.getArrowSize_();\n  arrowOuter.style['position'] = arrowInner.style['position'] = 'absolute';\n  arrowOuter.style['left'] = arrowInner.style['left'] = '50%';\n  arrowOuter.style['height'] = arrowInner.style['height'] = '0';\n  arrowOuter.style['width'] = arrowInner.style['width'] = '0';\n  arrowOuter.style['marginLeft'] = this.px(-arrowSize);\n  arrowOuter.style['borderWidth'] = this.px(arrowSize);\n  arrowOuter.style['borderBottomWidth'] = 0; // Shadow\n\n  var bubbleShadow = this.bubbleShadow_ = document.createElement('DIV');\n  bubbleShadow.style['position'] = 'absolute'; // Hide the InfoBubble by default\n\n  bubble.style['display'] = bubbleShadow.style['display'] = 'none';\n  bubble.appendChild(this.tabsContainer_);\n  bubble.appendChild(close);\n  bubble.appendChild(contentContainer);\n  arrow.appendChild(arrowOuter);\n  arrow.appendChild(arrowInner);\n  bubble.appendChild(arrow);\n  var stylesheet = document.createElement('style');\n  stylesheet.setAttribute('type', 'text/css');\n  /**\n   * The animation for the infobubble\n   * @type {string}\n   */\n\n  this.animationName_ = '_ibani_' + Math.round(Math.random() * 10000);\n  var css = '.' + this.animationName_ + '{-webkit-animation-name:' + this.animationName_ + ';-webkit-animation-duration:0.5s;' + '-webkit-animation-iteration-count:1;}' + '@-webkit-keyframes ' + this.animationName_ + ' {from {' + '-webkit-transform: scale(0)}50% {-webkit-transform: scale(1.2)}90% ' + '{-webkit-transform: scale(0.95)}to {-webkit-transform: scale(1)}}';\n  stylesheet.textContent = css;\n  document.getElementsByTagName('head')[0].appendChild(stylesheet);\n};\n/**\n * Sets the background class name\n *\n * @param {string} className The class name to set.\n */\n\n\nInfoBubble.prototype.setBackgroundClassName = function (className) {\n  this.set('backgroundClassName', className);\n};\n\nInfoBubble.prototype['setBackgroundClassName'] = InfoBubble.prototype.setBackgroundClassName;\n/**\n * changed MVC callback\n */\n\nInfoBubble.prototype.backgroundClassName_changed = function () {\n  this.content_.className = this.get('backgroundClassName');\n};\n\nInfoBubble.prototype['backgroundClassName_changed'] = InfoBubble.prototype.backgroundClassName_changed;\n/**\n * Sets the class of the tab\n *\n * @param {string} className the class name to set.\n */\n\nInfoBubble.prototype.setTabClassName = function (className) {\n  this.set('tabClassName', className);\n};\n\nInfoBubble.prototype['setTabClassName'] = InfoBubble.prototype.setTabClassName;\n/**\n * tabClassName changed MVC callback\n */\n\nInfoBubble.prototype.tabClassName_changed = function () {\n  this.updateTabStyles_();\n};\n\nInfoBubble.prototype['tabClassName_changed'] = InfoBubble.prototype.tabClassName_changed;\n/**\n * Gets the style of the arrow\n *\n * @private\n * @return {number} The style of the arrow.\n */\n\nInfoBubble.prototype.getArrowStyle_ = function () {\n  return parseInt(this.get('arrowStyle'), 10) || 0;\n};\n/**\n * Sets the style of the arrow\n *\n * @param {number} style The style of the arrow.\n */\n\n\nInfoBubble.prototype.setArrowStyle = function (style) {\n  this.set('arrowStyle', style);\n};\n\nInfoBubble.prototype['setArrowStyle'] = InfoBubble.prototype.setArrowStyle;\n/**\n * Arrow style changed MVC callback\n */\n\nInfoBubble.prototype.arrowStyle_changed = function () {\n  this.arrowSize_changed();\n};\n\nInfoBubble.prototype['arrowStyle_changed'] = InfoBubble.prototype.arrowStyle_changed;\n/**\n * Gets the size of the arrow\n *\n * @private\n * @return {number} The size of the arrow.\n */\n\nInfoBubble.prototype.getArrowSize_ = function () {\n  return parseInt(this.get('arrowSize'), 10) || 0;\n};\n/**\n * Sets the size of the arrow\n *\n * @param {number} size The size of the arrow.\n */\n\n\nInfoBubble.prototype.setArrowSize = function (size) {\n  this.set('arrowSize', size);\n};\n\nInfoBubble.prototype['setArrowSize'] = InfoBubble.prototype.setArrowSize;\n/**\n * Arrow size changed MVC callback\n */\n\nInfoBubble.prototype.arrowSize_changed = function () {\n  this.borderWidth_changed();\n};\n\nInfoBubble.prototype['arrowSize_changed'] = InfoBubble.prototype.arrowSize_changed;\n/**\n * Set the position of the InfoBubble arrow\n *\n * @param {number} pos The position to set.\n */\n\nInfoBubble.prototype.setArrowPosition = function (pos) {\n  this.set('arrowPosition', pos);\n};\n\nInfoBubble.prototype['setArrowPosition'] = InfoBubble.prototype.setArrowPosition;\n/**\n * Get the position of the InfoBubble arrow\n *\n * @private\n * @return {number} The position..\n */\n\nInfoBubble.prototype.getArrowPosition_ = function () {\n  return parseInt(this.get('arrowPosition'), 10) || 0;\n};\n/**\n * arrowPosition changed MVC callback\n */\n\n\nInfoBubble.prototype.arrowPosition_changed = function () {\n  var pos = this.getArrowPosition_();\n  this.arrowOuter_.style['left'] = this.arrowInner_.style['left'] = pos + '%';\n  this.redraw_();\n};\n\nInfoBubble.prototype['arrowPosition_changed'] = InfoBubble.prototype.arrowPosition_changed;\n/**\n * Set the zIndex of the InfoBubble\n *\n * @param {number} zIndex The zIndex to set.\n */\n\nInfoBubble.prototype.setZIndex = function (zIndex) {\n  this.set('zIndex', zIndex);\n};\n\nInfoBubble.prototype['setZIndex'] = InfoBubble.prototype.setZIndex;\n/**\n * Get the zIndex of the InfoBubble\n *\n * @return {number} The zIndex to set.\n */\n\nInfoBubble.prototype.getZIndex = function () {\n  return parseInt(this.get('zIndex'), 10) || this.baseZIndex_;\n};\n/**\n * zIndex changed MVC callback\n */\n\n\nInfoBubble.prototype.zIndex_changed = function () {\n  var zIndex = this.getZIndex();\n  this.bubble_.style['zIndex'] = this.baseZIndex_ = zIndex;\n  this.close_.style['zIndex'] = zIndex + 1;\n};\n\nInfoBubble.prototype['zIndex_changed'] = InfoBubble.prototype.zIndex_changed;\n/**\n * Set the style of the shadow\n *\n * @param {number} shadowStyle The style of the shadow.\n */\n\nInfoBubble.prototype.setShadowStyle = function (shadowStyle) {\n  this.set('shadowStyle', shadowStyle);\n};\n\nInfoBubble.prototype['setShadowStyle'] = InfoBubble.prototype.setShadowStyle;\n/**\n * Get the style of the shadow\n *\n * @private\n * @return {number} The style of the shadow.\n */\n\nInfoBubble.prototype.getShadowStyle_ = function () {\n  return parseInt(this.get('shadowStyle'), 10) || 0;\n};\n/**\n * shadowStyle changed MVC callback\n */\n\n\nInfoBubble.prototype.shadowStyle_changed = function () {\n  var shadowStyle = this.getShadowStyle_();\n  var display = '';\n  var shadow = '';\n  var backgroundColor = '';\n\n  switch (shadowStyle) {\n    case 0:\n      display = 'none';\n      break;\n\n    case 1:\n      shadow = '40px 15px 10px rgba(33,33,33,0.3)';\n      backgroundColor = 'transparent';\n      break;\n\n    case 2:\n      shadow = '0 0 2px rgba(33,33,33,0.3)';\n      backgroundColor = 'rgba(33,33,33,0.35)';\n      break;\n  }\n\n  this.bubbleShadow_.style['boxShadow'] = this.bubbleShadow_.style['webkitBoxShadow'] = this.bubbleShadow_.style['MozBoxShadow'] = shadow;\n  this.bubbleShadow_.style['backgroundColor'] = backgroundColor;\n\n  if (this.isOpen_) {\n    this.bubbleShadow_.style['display'] = display;\n    this.draw();\n  }\n};\n\nInfoBubble.prototype['shadowStyle_changed'] = InfoBubble.prototype.shadowStyle_changed;\n/**\n * Show the close button\n */\n\nInfoBubble.prototype.showCloseButton = function () {\n  this.set('hideCloseButton', false);\n};\n\nInfoBubble.prototype['showCloseButton'] = InfoBubble.prototype.showCloseButton;\n/**\n * Hide the close button\n */\n\nInfoBubble.prototype.hideCloseButton = function () {\n  this.set('hideCloseButton', true);\n};\n\nInfoBubble.prototype['hideCloseButton'] = InfoBubble.prototype.hideCloseButton;\n/**\n * hideCloseButton changed MVC callback\n */\n\nInfoBubble.prototype.hideCloseButton_changed = function () {\n  this.close_.style['display'] = this.get('hideCloseButton') ? 'none' : '';\n};\n\nInfoBubble.prototype['hideCloseButton_changed'] = InfoBubble.prototype.hideCloseButton_changed;\n/**\n * Set the background color\n *\n * @param {string} color The color to set.\n */\n\nInfoBubble.prototype.setBackgroundColor = function (color) {\n  if (color) {\n    this.set('backgroundColor', color);\n  }\n};\n\nInfoBubble.prototype['setBackgroundColor'] = InfoBubble.prototype.setBackgroundColor;\n/**\n * backgroundColor changed MVC callback\n */\n\nInfoBubble.prototype.backgroundColor_changed = function () {\n  var backgroundColor = this.get('backgroundColor');\n  this.contentContainer_.style['backgroundColor'] = backgroundColor;\n  this.arrowInner_.style['borderColor'] = backgroundColor + ' transparent transparent';\n  this.updateTabStyles_();\n};\n\nInfoBubble.prototype['backgroundColor_changed'] = InfoBubble.prototype.backgroundColor_changed;\n/**\n * Set the border color\n *\n * @param {string} color The border color.\n */\n\nInfoBubble.prototype.setBorderColor = function (color) {\n  if (color) {\n    this.set('borderColor', color);\n  }\n};\n\nInfoBubble.prototype['setBorderColor'] = InfoBubble.prototype.setBorderColor;\n/**\n * borderColor changed MVC callback\n */\n\nInfoBubble.prototype.borderColor_changed = function () {\n  var borderColor = this.get('borderColor');\n  var contentContainer = this.contentContainer_;\n  var arrowOuter = this.arrowOuter_;\n  contentContainer.style['borderColor'] = borderColor;\n  arrowOuter.style['borderColor'] = borderColor + ' transparent transparent';\n  contentContainer.style['borderStyle'] = arrowOuter.style['borderStyle'] = this.arrowInner_.style['borderStyle'] = 'solid';\n  this.updateTabStyles_();\n};\n\nInfoBubble.prototype['borderColor_changed'] = InfoBubble.prototype.borderColor_changed;\n/**\n * Set the radius of the border\n *\n * @param {number} radius The radius of the border.\n */\n\nInfoBubble.prototype.setBorderRadius = function (radius) {\n  this.set('borderRadius', radius);\n};\n\nInfoBubble.prototype['setBorderRadius'] = InfoBubble.prototype.setBorderRadius;\n/**\n * Get the radius of the border\n *\n * @private\n * @return {number} The radius of the border.\n */\n\nInfoBubble.prototype.getBorderRadius_ = function () {\n  return parseInt(this.get('borderRadius'), 10) || 0;\n};\n/**\n * borderRadius changed MVC callback\n */\n\n\nInfoBubble.prototype.borderRadius_changed = function () {\n  var borderRadius = this.getBorderRadius_();\n  var borderWidth = this.getBorderWidth_();\n  this.contentContainer_.style['borderRadius'] = this.contentContainer_.style['MozBorderRadius'] = this.contentContainer_.style['webkitBorderRadius'] = this.bubbleShadow_.style['borderRadius'] = this.bubbleShadow_.style['MozBorderRadius'] = this.bubbleShadow_.style['webkitBorderRadius'] = this.px(borderRadius);\n  this.tabsContainer_.style['paddingLeft'] = this.tabsContainer_.style['paddingRight'] = this.px(borderRadius + borderWidth);\n  this.redraw_();\n};\n\nInfoBubble.prototype['borderRadius_changed'] = InfoBubble.prototype.borderRadius_changed;\n/**\n * Get the width of the border\n *\n * @private\n * @return {number} width The width of the border.\n */\n\nInfoBubble.prototype.getBorderWidth_ = function () {\n  return parseInt(this.get('borderWidth'), 10) || 0;\n};\n/**\n * Set the width of the border\n *\n * @param {number} width The width of the border.\n */\n\n\nInfoBubble.prototype.setBorderWidth = function (width) {\n  this.set('borderWidth', width);\n};\n\nInfoBubble.prototype['setBorderWidth'] = InfoBubble.prototype.setBorderWidth;\n/**\n * borderWidth change MVC callback\n */\n\nInfoBubble.prototype.borderWidth_changed = function () {\n  var borderWidth = this.getBorderWidth_();\n  this.contentContainer_.style['borderWidth'] = this.px(borderWidth);\n  this.tabsContainer_.style['top'] = this.px(borderWidth);\n  this.updateArrowStyle_();\n  this.updateTabStyles_();\n  this.borderRadius_changed();\n  this.redraw_();\n};\n\nInfoBubble.prototype['borderWidth_changed'] = InfoBubble.prototype.borderWidth_changed;\n/**\n * Update the arrow style\n * @private\n */\n\nInfoBubble.prototype.updateArrowStyle_ = function () {\n  var borderWidth = this.getBorderWidth_();\n  var arrowSize = this.getArrowSize_();\n  var arrowStyle = this.getArrowStyle_();\n  var arrowOuterSizePx = this.px(arrowSize);\n  var arrowInnerSizePx = this.px(Math.max(0, arrowSize - borderWidth));\n  var outer = this.arrowOuter_;\n  var inner = this.arrowInner_;\n  this.arrow_.style['marginTop'] = this.px(-borderWidth);\n  outer.style['borderTopWidth'] = arrowOuterSizePx;\n  inner.style['borderTopWidth'] = arrowInnerSizePx; // Full arrow or arrow pointing to the left\n\n  if (arrowStyle == 0 || arrowStyle == 1) {\n    outer.style['borderLeftWidth'] = arrowOuterSizePx;\n    inner.style['borderLeftWidth'] = arrowInnerSizePx;\n  } else {\n    outer.style['borderLeftWidth'] = inner.style['borderLeftWidth'] = 0;\n  } // Full arrow or arrow pointing to the right\n\n\n  if (arrowStyle == 0 || arrowStyle == 2) {\n    outer.style['borderRightWidth'] = arrowOuterSizePx;\n    inner.style['borderRightWidth'] = arrowInnerSizePx;\n  } else {\n    outer.style['borderRightWidth'] = inner.style['borderRightWidth'] = 0;\n  }\n\n  if (arrowStyle < 2) {\n    outer.style['marginLeft'] = this.px(-arrowSize);\n    inner.style['marginLeft'] = this.px(-(arrowSize - borderWidth));\n  } else {\n    outer.style['marginLeft'] = inner.style['marginLeft'] = 0;\n  } // If there is no border then don't show thw outer arrow\n\n\n  if (borderWidth == 0) {\n    outer.style['display'] = 'none';\n  } else {\n    outer.style['display'] = '';\n  }\n};\n/**\n * Set the padding of the InfoBubble\n *\n * @param {number} padding The padding to apply.\n */\n\n\nInfoBubble.prototype.setPadding = function (padding) {\n  this.set('padding', padding);\n};\n\nInfoBubble.prototype['setPadding'] = InfoBubble.prototype.setPadding;\n/**\n * Set the close image url\n *\n * @param {string} src The url of the image used as a close icon\n */\n\nInfoBubble.prototype.setCloseSrc = function (src) {\n  if (src && this.close_) {\n    this.close_.src = src;\n  }\n};\n\nInfoBubble.prototype['setCloseSrc'] = InfoBubble.prototype.setCloseSrc;\n/**\n * Set the padding of the InfoBubble\n *\n * @private\n * @return {number} padding The padding to apply.\n */\n\nInfoBubble.prototype.getPadding_ = function () {\n  return parseInt(this.get('padding'), 10) || 0;\n};\n/**\n * padding changed MVC callback\n */\n\n\nInfoBubble.prototype.padding_changed = function () {\n  var padding = this.getPadding_();\n  this.contentContainer_.style['padding'] = this.px(padding);\n  this.updateTabStyles_();\n  this.redraw_();\n};\n\nInfoBubble.prototype['padding_changed'] = InfoBubble.prototype.padding_changed;\n/**\n * Add px extention to the number\n *\n * @param {number} num The number to wrap.\n * @return {string|number} A wrapped number.\n */\n\nInfoBubble.prototype.px = function (num) {\n  if (num) {\n    // 0 doesn't need to be wrapped\n    return num + 'px';\n  }\n\n  return num;\n};\n/**\n * Add events to stop propagation\n * @private\n */\n\n\nInfoBubble.prototype.addEvents_ = function () {\n  // We want to cancel all the events so they do not go to the map\n  var events = ['mousedown', 'mousemove', 'mouseover', 'mouseout', 'mouseup', 'mousewheel', 'DOMMouseScroll', 'touchstart', 'touchend', 'touchmove', 'dblclick', 'contextmenu', 'click'];\n  var bubble = this.bubble_;\n  this.listeners_ = [];\n\n  for (var i = 0, event; event = events[i]; i++) {\n    this.listeners_.push(google.maps.event.addDomListener(bubble, event, function (e) {\n      e.cancelBubble = true;\n\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n    }));\n  }\n};\n/**\n * On Adding the InfoBubble to a map\n * Implementing the OverlayView interface\n */\n\n\nInfoBubble.prototype.onAdd = function () {\n  if (!this.bubble_) {\n    this.buildDom_();\n  }\n\n  this.addEvents_();\n  var panes = this.getPanes();\n\n  if (panes) {\n    panes.floatPane.appendChild(this.bubble_);\n    panes.floatShadow.appendChild(this.bubbleShadow_);\n  }\n  /* once the infoBubble has been added to the DOM, fire 'domready' event */\n\n\n  google.maps.event.trigger(this, 'domready');\n};\n\nInfoBubble.prototype['onAdd'] = InfoBubble.prototype.onAdd;\n/**\n * Draw the InfoBubble\n * Implementing the OverlayView interface\n */\n\nInfoBubble.prototype.draw = function () {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  var latLng =\n  /** @type {google.maps.LatLng} */\n  this.get('position');\n\n  if (!latLng) {\n    this.close();\n    return;\n  }\n\n  var tabHeight = 0;\n\n  if (this.activeTab_) {\n    tabHeight = this.activeTab_.offsetHeight;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var arrowSize = this.getArrowSize_();\n  var arrowPosition = this.getArrowPosition_();\n  arrowPosition = arrowPosition / 100;\n  var pos = projection.fromLatLngToDivPixel(latLng);\n  var width = this.contentContainer_.offsetWidth;\n  var height = this.bubble_.offsetHeight;\n\n  if (!width) {\n    return;\n  } // Adjust for the height of the info bubble\n\n\n  var top = pos.y - (height + arrowSize);\n\n  if (anchorHeight) {\n    // If there is an anchor then include the height\n    top -= anchorHeight;\n  }\n\n  var left = pos.x - width * arrowPosition;\n  this.bubble_.style['top'] = this.px(top);\n  this.bubble_.style['left'] = this.px(left);\n  var shadowStyle = parseInt(this.get('shadowStyle'), 10);\n\n  switch (shadowStyle) {\n    case 1:\n      // Shadow is behind\n      this.bubbleShadow_.style['top'] = this.px(top + tabHeight - 1);\n      this.bubbleShadow_.style['left'] = this.px(left);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(this.contentContainer_.offsetHeight - arrowSize);\n      break;\n\n    case 2:\n      // Shadow is below\n      width = width * 0.8;\n\n      if (anchorHeight) {\n        this.bubbleShadow_.style['top'] = this.px(pos.y);\n      } else {\n        this.bubbleShadow_.style['top'] = this.px(pos.y + arrowSize);\n      }\n\n      this.bubbleShadow_.style['left'] = this.px(pos.x - width * arrowPosition);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(2);\n      break;\n  }\n};\n\nInfoBubble.prototype['draw'] = InfoBubble.prototype.draw;\n/**\n * Removing the InfoBubble from a map\n */\n\nInfoBubble.prototype.onRemove = function () {\n  if (this.bubble_ && this.bubble_.parentNode) {\n    this.bubble_.parentNode.removeChild(this.bubble_);\n  }\n\n  if (this.bubbleShadow_ && this.bubbleShadow_.parentNode) {\n    this.bubbleShadow_.parentNode.removeChild(this.bubbleShadow_);\n  }\n\n  for (var i = 0, listener; listener = this.listeners_[i]; i++) {\n    google.maps.event.removeListener(listener);\n  }\n};\n\nInfoBubble.prototype['onRemove'] = InfoBubble.prototype.onRemove;\n/**\n * Is the InfoBubble open\n *\n * @return {boolean} If the InfoBubble is open.\n */\n\nInfoBubble.prototype.isOpen = function () {\n  return this.isOpen_;\n};\n\nInfoBubble.prototype['isOpen'] = InfoBubble.prototype.isOpen;\n/**\n * Close the InfoBubble\n */\n\nInfoBubble.prototype.close = function () {\n  if (this.bubble_) {\n    this.bubble_.style['display'] = 'none'; // Remove the animation so we next time it opens it will animate again\n\n    this.bubble_.className = this.bubble_.className.replace(this.animationName_, '');\n  }\n\n  if (this.bubbleShadow_) {\n    this.bubbleShadow_.style['display'] = 'none';\n    this.bubbleShadow_.className = this.bubbleShadow_.className.replace(this.animationName_, '');\n  }\n\n  this.isOpen_ = false;\n};\n\nInfoBubble.prototype['close'] = InfoBubble.prototype.close;\n/**\n * Open the InfoBubble (asynchronous).\n *\n * @param {google.maps.Map=} opt_map Optional map to open on.\n * @param {google.maps.MVCObject=} opt_anchor Optional anchor to position at.\n */\n\nInfoBubble.prototype.open = function (opt_map, opt_anchor) {\n  var that = this;\n  window.setTimeout(function () {\n    that.open_(opt_map, opt_anchor);\n  }, 0);\n};\n/**\n * Open the InfoBubble\n * @private\n * @param {google.maps.Map=} opt_map Optional map to open on.\n * @param {google.maps.MVCObject=} opt_anchor Optional anchor to position at.\n */\n\n\nInfoBubble.prototype.open_ = function (opt_map, opt_anchor) {\n  this.updateContent_();\n\n  if (opt_map) {\n    this.setMap(opt_map);\n  }\n\n  if (opt_anchor) {\n    this.set('anchor', opt_anchor);\n    this.bindTo('anchorPoint', opt_anchor);\n    this.bindTo('position', opt_anchor);\n  } // Show the bubble and the show\n\n\n  this.bubble_.style['display'] = this.bubbleShadow_.style['display'] = '';\n  var animation = !this.get('disableAnimation');\n\n  if (animation) {\n    // Add the animation\n    this.bubble_.className += ' ' + this.animationName_;\n    this.bubbleShadow_.className += ' ' + this.animationName_;\n  }\n\n  this.redraw_();\n  this.isOpen_ = true;\n  var pan = !this.get('disableAutoPan');\n\n  if (pan) {\n    var that = this;\n    window.setTimeout(function () {\n      // Pan into view, done in a time out to make it feel nicer :)\n      that.panToView();\n    }, 200);\n  }\n};\n\nInfoBubble.prototype['open'] = InfoBubble.prototype.open;\n/**\n * Set the position of the InfoBubble\n *\n * @param {google.maps.LatLng} position The position to set.\n */\n\nInfoBubble.prototype.setPosition = function (position) {\n  if (position) {\n    this.set('position', position);\n  }\n};\n\nInfoBubble.prototype['setPosition'] = InfoBubble.prototype.setPosition;\n/**\n * Returns the position of the InfoBubble\n *\n * @return {google.maps.LatLng} the position.\n */\n\nInfoBubble.prototype.getPosition = function () {\n  return (\n    /** @type {google.maps.LatLng} */\n    this.get('position')\n  );\n};\n\nInfoBubble.prototype['getPosition'] = InfoBubble.prototype.getPosition;\n/**\n * position changed MVC callback\n */\n\nInfoBubble.prototype.position_changed = function () {\n  this.draw();\n};\n\nInfoBubble.prototype['position_changed'] = InfoBubble.prototype.position_changed;\n/**\n * Pan the InfoBubble into view\n */\n\nInfoBubble.prototype.panToView = function () {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  if (!this.bubble_) {\n    // No Bubble yet so do nothing\n    return;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var height = this.bubble_.offsetHeight + anchorHeight;\n  var map = this.get('map');\n  var mapDiv = map.getDiv();\n  var mapHeight = mapDiv.offsetHeight;\n  var latLng = this.getPosition();\n  var centerPos = projection.fromLatLngToContainerPixel(map.getCenter());\n  var pos = projection.fromLatLngToContainerPixel(latLng); // Find out how much space at the top is free\n\n  var spaceTop = centerPos.y - height; // Fine out how much space at the bottom is free\n\n  var spaceBottom = mapHeight - centerPos.y;\n  var needsTop = spaceTop < 0;\n  var deltaY = 0;\n\n  if (needsTop) {\n    spaceTop *= -1;\n    deltaY = (spaceTop + spaceBottom) / 2;\n  }\n\n  pos.y -= deltaY;\n  latLng = projection.fromContainerPixelToLatLng(pos);\n\n  if (map.getCenter() != latLng) {\n    map.panTo(latLng);\n  }\n};\n\nInfoBubble.prototype['panToView'] = InfoBubble.prototype.panToView;\n/**\n * Converts a HTML string to a document fragment.\n *\n * @param {string} htmlString The HTML string to convert.\n * @return {Node} A HTML document fragment.\n * @private\n */\n\nInfoBubble.prototype.htmlToDocumentFragment_ = function (htmlString) {\n  htmlString = htmlString.replace(/^\\s*([\\S\\s]*)\\b\\s*$/, '$1');\n  var tempDiv = document.createElement('DIV');\n  tempDiv.innerHTML = htmlString;\n\n  if (tempDiv.childNodes.length == 1) {\n    return (\n      /** @type {!Node} */\n      tempDiv.removeChild(tempDiv.firstChild)\n    );\n  } else {\n    var fragment = document.createDocumentFragment();\n\n    while (tempDiv.firstChild) {\n      fragment.appendChild(tempDiv.firstChild);\n    }\n\n    return fragment;\n  }\n};\n/**\n * Removes all children from the node.\n *\n * @param {Node} node The node to remove all children from.\n * @private\n */\n\n\nInfoBubble.prototype.removeChildren_ = function (node) {\n  if (!node) {\n    return;\n  }\n\n  var child;\n\n  while (child = node.firstChild) {\n    node.removeChild(child);\n  }\n};\n/**\n * Sets the content of the infobubble.\n *\n * @param {string|Node} content The content to set.\n */\n\n\nInfoBubble.prototype.setContent = function (content) {\n  this.set('content', content);\n};\n\nInfoBubble.prototype['setContent'] = InfoBubble.prototype.setContent;\n/**\n * Get the content of the infobubble.\n *\n * @return {string|Node} The marker content.\n */\n\nInfoBubble.prototype.getContent = function () {\n  return (\n    /** @type {Node|string} */\n    this.get('content')\n  );\n};\n\nInfoBubble.prototype['getContent'] = InfoBubble.prototype.getContent;\n/**\n * Sets the marker content and adds loading events to images\n */\n\nInfoBubble.prototype.updateContent_ = function () {\n  if (!this.content_) {\n    // The Content area doesnt exist.\n    return;\n  }\n\n  this.removeChildren_(this.content_);\n  var content = this.getContent();\n\n  if (content) {\n    if (typeof content == 'string') {\n      content = this.htmlToDocumentFragment_(content);\n    }\n\n    this.content_.appendChild(content);\n    var that = this;\n    var images = this.content_.getElementsByTagName('IMG');\n\n    for (var i = 0, image; image = images[i]; i++) {\n      // Because we don't know the size of an image till it loads, add a\n      // listener to the image load so the marker can resize and reposition\n      // itself to be the correct height.\n      google.maps.event.addDomListener(image, 'load', function () {\n        that.imageLoaded_();\n      });\n    }\n  }\n\n  this.redraw_();\n};\n/**\n * Image loaded\n * @private\n */\n\n\nInfoBubble.prototype.imageLoaded_ = function () {\n  var pan = !this.get('disableAutoPan');\n  this.redraw_();\n\n  if (pan && (this.tabs_.length == 0 || this.activeTab_.index == 0)) {\n    this.panToView();\n  }\n};\n/**\n * Updates the styles of the tabs\n * @private\n */\n\n\nInfoBubble.prototype.updateTabStyles_ = function () {\n  if (this.tabs_ && this.tabs_.length) {\n    for (var i = 0, tab; tab = this.tabs_[i]; i++) {\n      this.setTabStyle_(tab.tab);\n    }\n\n    this.activeTab_.style['zIndex'] = this.baseZIndex_;\n    var borderWidth = this.getBorderWidth_();\n    var padding = this.getPadding_() / 2;\n    this.activeTab_.style['borderBottomWidth'] = 0;\n    this.activeTab_.style['paddingBottom'] = this.px(padding + borderWidth);\n  }\n};\n/**\n * Sets the style of a tab\n * @private\n * @param {Element} tab The tab to style.\n */\n\n\nInfoBubble.prototype.setTabStyle_ = function (tab) {\n  var backgroundColor = this.get('backgroundColor');\n  var borderColor = this.get('borderColor');\n  var borderRadius = this.getBorderRadius_();\n  var borderWidth = this.getBorderWidth_();\n  var padding = this.getPadding_();\n  var marginRight = this.px(-Math.max(padding, borderRadius));\n  var borderRadiusPx = this.px(borderRadius);\n  var index = this.baseZIndex_;\n\n  if (tab.index) {\n    index -= tab.index;\n  } // The styles for the tab\n\n\n  var styles = {\n    'cssFloat': 'left',\n    'position': 'relative',\n    'cursor': 'pointer',\n    'backgroundColor': backgroundColor,\n    'border': this.px(borderWidth) + ' solid ' + borderColor,\n    'padding': this.px(padding / 2) + ' ' + this.px(padding),\n    'marginRight': marginRight,\n    'whiteSpace': 'nowrap',\n    'borderRadiusTopLeft': borderRadiusPx,\n    'MozBorderRadiusTopleft': borderRadiusPx,\n    'webkitBorderTopLeftRadius': borderRadiusPx,\n    'borderRadiusTopRight': borderRadiusPx,\n    'MozBorderRadiusTopright': borderRadiusPx,\n    'webkitBorderTopRightRadius': borderRadiusPx,\n    'zIndex': index,\n    'display': 'inline'\n  };\n\n  for (var style in styles) {\n    tab.style[style] = styles[style];\n  }\n\n  var className = this.get('tabClassName');\n\n  if (className != undefined) {\n    tab.className += ' ' + className;\n  }\n};\n/**\n * Add user actions to a tab\n * @private\n * @param {Object} tab The tab to add the actions to.\n */\n\n\nInfoBubble.prototype.addTabActions_ = function (tab) {\n  var that = this;\n  tab.listener_ = google.maps.event.addDomListener(tab, 'click', function () {\n    that.setTabActive_(this);\n  });\n};\n/**\n * Set a tab at a index to be active\n *\n * @param {number} index The index of the tab.\n */\n\n\nInfoBubble.prototype.setTabActive = function (index) {\n  var tab = this.tabs_[index - 1];\n\n  if (tab) {\n    this.setTabActive_(tab.tab);\n  }\n};\n\nInfoBubble.prototype['setTabActive'] = InfoBubble.prototype.setTabActive;\n/**\n * Set a tab to be active\n * @private\n * @param {Object} tab The tab to set active.\n */\n\nInfoBubble.prototype.setTabActive_ = function (tab) {\n  if (!tab) {\n    this.setContent('');\n    this.updateContent_();\n    return;\n  }\n\n  var padding = this.getPadding_() / 2;\n  var borderWidth = this.getBorderWidth_();\n\n  if (this.activeTab_) {\n    var activeTab = this.activeTab_;\n    activeTab.style['zIndex'] = this.baseZIndex_ - activeTab.index;\n    activeTab.style['paddingBottom'] = this.px(padding);\n    activeTab.style['borderBottomWidth'] = this.px(borderWidth);\n  }\n\n  tab.style['zIndex'] = this.baseZIndex_;\n  tab.style['borderBottomWidth'] = 0;\n  tab.style['marginBottomWidth'] = '-10px';\n  tab.style['paddingBottom'] = this.px(padding + borderWidth);\n  this.setContent(this.tabs_[tab.index].content);\n  this.updateContent_();\n  this.activeTab_ = tab;\n  this.redraw_();\n};\n/**\n * Set the max width of the InfoBubble\n *\n * @param {number} width The max width.\n */\n\n\nInfoBubble.prototype.setMaxWidth = function (width) {\n  this.set('maxWidth', width);\n};\n\nInfoBubble.prototype['setMaxWidth'] = InfoBubble.prototype.setMaxWidth;\n/**\n * maxWidth changed MVC callback\n */\n\nInfoBubble.prototype.maxWidth_changed = function () {\n  this.redraw_();\n};\n\nInfoBubble.prototype['maxWidth_changed'] = InfoBubble.prototype.maxWidth_changed;\n/**\n * Set the max height of the InfoBubble\n *\n * @param {number} height The max height.\n */\n\nInfoBubble.prototype.setMaxHeight = function (height) {\n  this.set('maxHeight', height);\n};\n\nInfoBubble.prototype['setMaxHeight'] = InfoBubble.prototype.setMaxHeight;\n/**\n * maxHeight changed MVC callback\n */\n\nInfoBubble.prototype.maxHeight_changed = function () {\n  this.redraw_();\n};\n\nInfoBubble.prototype['maxHeight_changed'] = InfoBubble.prototype.maxHeight_changed;\n/**\n * Set the min width of the InfoBubble\n *\n * @param {number} width The min width.\n */\n\nInfoBubble.prototype.setMinWidth = function (width) {\n  this.set('minWidth', width);\n};\n\nInfoBubble.prototype['setMinWidth'] = InfoBubble.prototype.setMinWidth;\n/**\n * minWidth changed MVC callback\n */\n\nInfoBubble.prototype.minWidth_changed = function () {\n  this.redraw_();\n};\n\nInfoBubble.prototype['minWidth_changed'] = InfoBubble.prototype.minWidth_changed;\n/**\n * Set the min height of the InfoBubble\n *\n * @param {number} height The min height.\n */\n\nInfoBubble.prototype.setMinHeight = function (height) {\n  this.set('minHeight', height);\n};\n\nInfoBubble.prototype['setMinHeight'] = InfoBubble.prototype.setMinHeight;\n/**\n * minHeight changed MVC callback\n */\n\nInfoBubble.prototype.minHeight_changed = function () {\n  this.redraw_();\n};\n\nInfoBubble.prototype['minHeight_changed'] = InfoBubble.prototype.minHeight_changed;\n/**\n * Add a tab\n *\n * @param {string} label The label of the tab.\n * @param {string|Element} content The content of the tab.\n */\n\nInfoBubble.prototype.addTab = function (label, content) {\n  var tab = document.createElement('DIV');\n  tab.innerHTML = label;\n  this.setTabStyle_(tab);\n  this.addTabActions_(tab);\n  this.tabsContainer_.appendChild(tab);\n  this.tabs_.push({\n    label: label,\n    content: content,\n    tab: tab\n  });\n  tab.index = this.tabs_.length - 1;\n  tab.style['zIndex'] = this.baseZIndex_ - tab.index;\n\n  if (!this.activeTab_) {\n    this.setTabActive_(tab);\n  }\n\n  tab.className = tab.className + ' ' + this.animationName_;\n  this.redraw_();\n};\n\nInfoBubble.prototype['addTab'] = InfoBubble.prototype.addTab;\n/**\n * Update a tab at a speicifc index\n *\n * @param {number} index The index of the tab.\n * @param {?string} opt_label The label to change to.\n * @param {?string} opt_content The content to update to.\n */\n\nInfoBubble.prototype.updateTab = function (index, opt_label, opt_content) {\n  if (!this.tabs_.length || index < 0 || index >= this.tabs_.length) {\n    return;\n  }\n\n  var tab = this.tabs_[index];\n\n  if (opt_label != undefined) {\n    tab.tab.innerHTML = tab.label = opt_label;\n  }\n\n  if (opt_content != undefined) {\n    tab.content = opt_content;\n  }\n\n  if (this.activeTab_ == tab.tab) {\n    this.setContent(tab.content);\n    this.updateContent_();\n  }\n\n  this.redraw_();\n};\n\nInfoBubble.prototype['updateTab'] = InfoBubble.prototype.updateTab;\n/**\n * Remove a tab at a specific index\n *\n * @param {number} index The index of the tab to remove.\n */\n\nInfoBubble.prototype.removeTab = function (index) {\n  if (!this.tabs_.length || index < 0 || index >= this.tabs_.length) {\n    return;\n  }\n\n  var tab = this.tabs_[index];\n  tab.tab.parentNode.removeChild(tab.tab);\n  google.maps.event.removeListener(tab.tab.listener_);\n  this.tabs_.splice(index, 1);\n  delete tab;\n\n  for (var i = 0, t; t = this.tabs_[i]; i++) {\n    t.tab.index = i;\n  }\n\n  if (tab.tab == this.activeTab_) {\n    // Removing the current active tab\n    if (this.tabs_[index]) {\n      // Show the tab to the right\n      this.activeTab_ = this.tabs_[index].tab;\n    } else if (this.tabs_[index - 1]) {\n      // Show a tab to the left\n      this.activeTab_ = this.tabs_[index - 1].tab;\n    } else {\n      // No tabs left to sho\n      this.activeTab_ = undefined;\n    }\n\n    this.setTabActive_(this.activeTab_);\n  }\n\n  this.redraw_();\n};\n\nInfoBubble.prototype['removeTab'] = InfoBubble.prototype.removeTab;\n/**\n * Get the size of an element\n * @private\n * @param {Node|string} element The element to size.\n * @param {number=} opt_maxWidth Optional max width of the element.\n * @param {number=} opt_maxHeight Optional max height of the element.\n * @return {google.maps.Size} The size of the element.\n */\n\nInfoBubble.prototype.getElementSize_ = function (element, opt_maxWidth, opt_maxHeight) {\n  var sizer = document.createElement('DIV');\n  sizer.style['display'] = 'inline';\n  sizer.style['position'] = 'absolute';\n  sizer.style['visibility'] = 'hidden';\n\n  if (typeof element == 'string') {\n    sizer.innerHTML = element;\n  } else {\n    sizer.appendChild(element.cloneNode(true));\n  }\n\n  document.body.appendChild(sizer);\n  var size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight); // If the width is bigger than the max width then set the width and size again\n\n  if (opt_maxWidth && size.width > opt_maxWidth) {\n    sizer.style['width'] = this.px(opt_maxWidth);\n    size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight);\n  } // If the height is bigger than the max height then set the height and size\n  // again\n\n\n  if (opt_maxHeight && size.height > opt_maxHeight) {\n    sizer.style['height'] = this.px(opt_maxHeight);\n    size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight);\n  }\n\n  document.body.removeChild(sizer);\n  delete sizer;\n  return size;\n};\n/**\n * Redraw the InfoBubble\n * @private\n */\n\n\nInfoBubble.prototype.redraw_ = function () {\n  this.figureOutSize_();\n  this.positionCloseButton_();\n  this.draw();\n};\n/**\n * Figure out the optimum size of the InfoBubble\n * @private\n */\n\n\nInfoBubble.prototype.figureOutSize_ = function () {\n  var map = this.get('map');\n\n  if (!map) {\n    return;\n  }\n\n  var padding = this.getPadding_();\n  var borderWidth = this.getBorderWidth_();\n  var borderRadius = this.getBorderRadius_();\n  var arrowSize = this.getArrowSize_();\n  var mapDiv = map.getDiv();\n  var gutter = arrowSize * 2;\n  var mapWidth = mapDiv.offsetWidth - gutter;\n  var mapHeight = mapDiv.offsetHeight - gutter - this.getAnchorHeight_();\n  var tabHeight = 0;\n  var width =\n  /** @type {number} */\n  this.get('minWidth') || 0;\n  var height =\n  /** @type {number} */\n  this.get('minHeight') || 0;\n  var maxWidth =\n  /** @type {number} */\n  this.get('maxWidth') || 0;\n  var maxHeight =\n  /** @type {number} */\n  this.get('maxHeight') || 0;\n  maxWidth = Math.min(mapWidth, maxWidth);\n  maxHeight = Math.min(mapHeight, maxHeight);\n  var tabWidth = 0;\n\n  if (this.tabs_.length) {\n    // If there are tabs then you need to check the size of each tab's content\n    for (var i = 0, tab; tab = this.tabs_[i]; i++) {\n      var tabSize = this.getElementSize_(tab.tab, maxWidth, maxHeight);\n      var contentSize = this.getElementSize_(tab.content, maxWidth, maxHeight);\n\n      if (width < tabSize.width) {\n        width = tabSize.width;\n      } // Add up all the tab widths because they might end up being wider than\n      // the content\n\n\n      tabWidth += tabSize.width;\n\n      if (height < tabSize.height) {\n        height = tabSize.height;\n      }\n\n      if (tabSize.height > tabHeight) {\n        tabHeight = tabSize.height;\n      }\n\n      if (width < contentSize.width) {\n        width = contentSize.width;\n      }\n\n      if (height < contentSize.height) {\n        height = contentSize.height;\n      }\n    }\n  } else {\n    var content =\n    /** @type {string|Node} */\n    this.get('content');\n\n    if (typeof content == 'string') {\n      content = this.htmlToDocumentFragment_(content);\n    }\n\n    if (content) {\n      var contentSize = this.getElementSize_(content, maxWidth, maxHeight);\n\n      if (width < contentSize.width) {\n        width = contentSize.width;\n      }\n\n      if (height < contentSize.height) {\n        height = contentSize.height;\n      }\n    }\n  }\n\n  if (maxWidth) {\n    width = Math.min(width, maxWidth);\n  }\n\n  if (maxHeight) {\n    height = Math.min(height, maxHeight);\n  }\n\n  width = Math.max(width, tabWidth);\n\n  if (width == tabWidth) {\n    width = width + 2 * padding;\n  }\n\n  arrowSize = arrowSize * 2;\n  width = Math.max(width, arrowSize); // Maybe add this as a option so they can go bigger than the map if the user\n  // wants\n\n  if (width > mapWidth) {\n    width = mapWidth;\n  }\n\n  if (height > mapHeight) {\n    height = mapHeight - tabHeight;\n  }\n\n  if (this.tabsContainer_) {\n    this.tabHeight_ = tabHeight;\n    this.tabsContainer_.style['width'] = this.px(tabWidth);\n  }\n\n  this.contentContainer_.style['width'] = this.px(width);\n  this.contentContainer_.style['height'] = this.px(height);\n};\n/**\n *  Get the height of the anchor\n *\n *  This function is a hack for now and doesn't really work that good, need to\n *  wait for pixelBounds to be correctly exposed.\n *  @private\n *  @return {number} The height of the anchor.\n */\n\n\nInfoBubble.prototype.getAnchorHeight_ = function () {\n  var anchor = this.get('anchor');\n\n  if (anchor) {\n    var anchorPoint =\n    /** @type google.maps.Point */\n    this.get('anchorPoint');\n\n    if (anchorPoint) {\n      return -1 * anchorPoint.y;\n    }\n  }\n\n  return 0;\n};\n\nInfoBubble.prototype.anchorPoint_changed = function () {\n  this.draw();\n};\n\nInfoBubble.prototype['anchorPoint_changed'] = InfoBubble.prototype.anchorPoint_changed;\n/**\n * Position the close button in the right spot.\n * @private\n */\n\nInfoBubble.prototype.positionCloseButton_ = function () {\n  var br = this.getBorderRadius_();\n  var bw = this.getBorderWidth_();\n  var right = 2;\n  var top = 2;\n\n  if (this.tabs_.length && this.tabHeight_) {\n    top += this.tabHeight_;\n  }\n\n  top += bw;\n  right += bw;\n  var c = this.contentContainer_;\n\n  if (c && c.clientHeight < c.scrollHeight) {\n    // If there are scrollbars then move the cross in so it is not over\n    // scrollbar\n    right += 15;\n  }\n\n  this.close_.style['right'] = this.px(right);\n  this.close_.style['top'] = this.px(top);\n};\n/*\n * Sets InfoBubble Position\n * */\n\n\nInfoBubble.prototype.setBubbleOffset = function (xOffset, yOffset) {\n  this.bubbleOffsetX = parseInt(xOffset);\n  this.bubbleOffsetY = parseInt(yOffset);\n};\n/*\n * Gets InfoBubble Position\n * */\n\n\nInfoBubble.prototype.getBubbleOffset = function () {\n  return {\n    x: this.bubbleOffsetX || 0,\n    y: this.bubbleOffsetY || 0\n  };\n};\n/**\n * Draw the InfoBubble\n * Implementing the OverlayView interface\n */\n\n\nInfoBubble.prototype.draw = function () {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  var latLng =\n  /** @type {google.maps.LatLng} */\n  this.get('position');\n\n  if (!latLng) {\n    this.close();\n    return;\n  }\n\n  var tabHeight = 0;\n\n  if (this.activeTab_) {\n    tabHeight = this.activeTab_.offsetHeight;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var arrowSize = this.getArrowSize_();\n  var arrowPosition = this.getArrowPosition_();\n  arrowPosition = arrowPosition / 100;\n  var pos = projection.fromLatLngToDivPixel(latLng);\n  var width = this.contentContainer_.offsetWidth;\n  var height = this.bubble_.offsetHeight;\n\n  if (!width) {\n    return;\n  } // Adjust for the height of the info bubble\n\n\n  var top = pos.y - (height + arrowSize) + this.getBubbleOffset().y;\n\n  if (anchorHeight) {\n    // If there is an anchor then include the height\n    top -= anchorHeight;\n  }\n\n  var left = pos.x - width * arrowPosition + this.getBubbleOffset().x;\n  this.bubble_.style['top'] = this.px(top);\n  this.bubble_.style['left'] = this.px(left);\n  var shadowStyle = parseInt(this.get('shadowStyle'), 10);\n\n  switch (shadowStyle) {\n    case 1:\n      // Shadow is behind\n      this.bubbleShadow_.style['top'] = this.px(top + tabHeight - 1);\n      this.bubbleShadow_.style['left'] = this.px(left);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(this.contentContainer_.offsetHeight - arrowSize);\n      break;\n\n    case 2:\n      // Shadow is below\n      width = width * 0.8;\n\n      if (anchorHeight) {\n        this.bubbleShadow_.style['top'] = this.px(pos.y);\n      } else {\n        this.bubbleShadow_.style['top'] = this.px(pos.y + arrowSize);\n      }\n\n      this.bubbleShadow_.style['left'] = this.px(pos.x - width * arrowPosition);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(2);\n      break;\n  }\n};\n\nmodule.exports = InfoBubble;","map":{"version":3,"sources":["D:/TT18-EC-Team1-FE/isomorphic/node_modules/@redq/js-info-bubble/src/infobubble.js"],"names":["InfoBubble","opt_options","extend","google","maps","OverlayView","tabs_","activeTab_","baseZIndex_","isOpen_","options","undefined","BACKGROUND_COLOR_","BORDER_COLOR_","BORDER_RADIUS_","BORDER_WIDTH_","PADDING_","ARROW_POSITION_","MIN_WIDTH_","SHADOW_STYLE_","ARROW_SIZE_","ARROW_STYLE_","CLOSE_SRC_","buildDom_","setValues","window","prototype","obj1","obj2","object","property","apply","bubble","bubble_","document","createElement","style","tabsContainer","tabsContainer_","close","close_","className","src","get","that","event","addDomListener","trigger","contentContainer","contentContainer_","content","content_","appendChild","arrow","arrow_","arrowOuter","arrowOuter_","arrowInner","arrowInner_","arrowSize","getArrowSize_","px","bubbleShadow","bubbleShadow_","stylesheet","setAttribute","animationName_","Math","round","random","css","textContent","getElementsByTagName","setBackgroundClassName","set","backgroundClassName_changed","setTabClassName","tabClassName_changed","updateTabStyles_","getArrowStyle_","parseInt","setArrowStyle","arrowStyle_changed","arrowSize_changed","setArrowSize","size","borderWidth_changed","setArrowPosition","pos","getArrowPosition_","arrowPosition_changed","redraw_","setZIndex","zIndex","getZIndex","zIndex_changed","setShadowStyle","shadowStyle","getShadowStyle_","shadowStyle_changed","display","shadow","backgroundColor","draw","showCloseButton","hideCloseButton","hideCloseButton_changed","setBackgroundColor","color","backgroundColor_changed","setBorderColor","borderColor_changed","borderColor","setBorderRadius","radius","getBorderRadius_","borderRadius_changed","borderRadius","borderWidth","getBorderWidth_","setBorderWidth","width","updateArrowStyle_","arrowStyle","arrowOuterSizePx","arrowInnerSizePx","max","outer","inner","setPadding","padding","setCloseSrc","getPadding_","padding_changed","num","addEvents_","events","listeners_","i","push","e","cancelBubble","stopPropagation","onAdd","panes","getPanes","floatPane","floatShadow","projection","getProjection","latLng","tabHeight","offsetHeight","anchorHeight","getAnchorHeight_","arrowPosition","fromLatLngToDivPixel","offsetWidth","height","top","y","left","x","onRemove","parentNode","removeChild","listener","removeListener","isOpen","replace","open","opt_map","opt_anchor","setTimeout","open_","updateContent_","setMap","bindTo","animation","pan","panToView","setPosition","position","getPosition","position_changed","map","mapDiv","getDiv","mapHeight","centerPos","fromLatLngToContainerPixel","getCenter","spaceTop","spaceBottom","needsTop","deltaY","fromContainerPixelToLatLng","panTo","htmlToDocumentFragment_","htmlString","tempDiv","innerHTML","childNodes","length","firstChild","fragment","createDocumentFragment","removeChildren_","node","child","setContent","getContent","images","image","imageLoaded_","index","tab","setTabStyle_","marginRight","borderRadiusPx","styles","addTabActions_","listener_","setTabActive_","setTabActive","activeTab","setMaxWidth","maxWidth_changed","setMaxHeight","maxHeight_changed","setMinWidth","minWidth_changed","setMinHeight","minHeight_changed","addTab","label","updateTab","opt_label","opt_content","removeTab","splice","t","getElementSize_","element","opt_maxWidth","opt_maxHeight","sizer","cloneNode","body","Size","figureOutSize_","positionCloseButton_","gutter","mapWidth","maxWidth","maxHeight","min","tabWidth","tabSize","contentSize","tabHeight_","anchor","anchorPoint","anchorPoint_changed","br","bw","right","c","clientHeight","scrollHeight","setBubbleOffset","xOffset","yOffset","bubbleOffsetX","bubbleOffsetY","getBubbleOffset","module","exports"],"mappings":"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","sourcesContent":["// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @externs_url https://raw.githubusercontent.com/google/closure-compiler/master/contrib/externs/maps/google_maps_api_v3_16.js\n// ==/ClosureCompiler==\n\n/**\n * @name CSS3 InfoBubble with tabs for Google Maps API V3\n * @version 0.8\n * @author Luke Mahe\n * @fileoverview\n * This library is a CSS Infobubble with tabs. It uses css3 rounded corners and\n * drop shadows and animations. It also allows tabs\n */\n\n/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * A CSS3 InfoBubble v0.8\n * @param {Object.<string, *>=} opt_options Optional properties to set.\n * @extends {google.maps.OverlayView}\n * @constructor\n */\nfunction InfoBubble(opt_options) {\n  this.extend(InfoBubble, google.maps.OverlayView);\n  this.tabs_ = [];\n  this.activeTab_ = null;\n  this.baseZIndex_ = 100;\n  this.isOpen_ = false;\n\n  var options = opt_options || {};\n\n  if (options['backgroundColor'] == undefined) {\n    options['backgroundColor'] = this.BACKGROUND_COLOR_;\n  }\n\n  if (options['borderColor'] == undefined) {\n    options['borderColor'] = this.BORDER_COLOR_;\n  }\n\n  if (options['borderRadius'] == undefined) {\n    options['borderRadius'] = this.BORDER_RADIUS_;\n  }\n\n  if (options['borderWidth'] == undefined) {\n    options['borderWidth'] = this.BORDER_WIDTH_;\n  }\n\n  if (options['padding'] == undefined) {\n    options['padding'] = this.PADDING_;\n  }\n\n  if (options['arrowPosition'] == undefined) {\n    options['arrowPosition'] = this.ARROW_POSITION_;\n  }\n\n  if (options['disableAutoPan'] == undefined) {\n    options['disableAutoPan'] = false;\n  }\n\n  if (options['disableAnimation'] == undefined) {\n    options['disableAnimation'] = false;\n  }\n\n  if (options['minWidth'] == undefined) {\n    options['minWidth'] = this.MIN_WIDTH_;\n  }\n\n  if (options['shadowStyle'] == undefined) {\n    options['shadowStyle'] = this.SHADOW_STYLE_;\n  }\n\n  if (options['arrowSize'] == undefined) {\n    options['arrowSize'] = this.ARROW_SIZE_;\n  }\n\n  if (options['arrowStyle'] == undefined) {\n    options['arrowStyle'] = this.ARROW_STYLE_;\n  }\n\n  if (options['closeSrc'] == undefined) {\n    options['closeSrc'] = this.CLOSE_SRC_;\n  }\n\n  this.buildDom_();\n  this.setValues(options);\n}\nwindow['InfoBubble'] = InfoBubble;\n\n\n/**\n * Default arrow size\n * @const\n * @private\n */\nInfoBubble.prototype.ARROW_SIZE_ = 15;\n\n\n/**\n * Default arrow style\n * @const\n * @private\n */\nInfoBubble.prototype.ARROW_STYLE_ = 0;\n\n\n/**\n * Default shadow style\n * @const\n * @private\n */\nInfoBubble.prototype.SHADOW_STYLE_ = 1;\n\n\n/**\n * Default min width\n * @const\n * @private\n */\nInfoBubble.prototype.MIN_WIDTH_ = 50;\n\n\n/**\n * Default arrow position\n * @const\n * @private\n */\nInfoBubble.prototype.ARROW_POSITION_ = 50;\n\n\n/**\n * Default padding\n * @const\n * @private\n */\nInfoBubble.prototype.PADDING_ = 10;\n\n\n/**\n * Default border width\n * @const\n * @private\n */\nInfoBubble.prototype.BORDER_WIDTH_ = 1;\n\n\n/**\n * Default border color\n * @const\n * @private\n */\nInfoBubble.prototype.BORDER_COLOR_ = '#ccc';\n\n\n/**\n * Default border radius\n * @const\n * @private\n */\nInfoBubble.prototype.BORDER_RADIUS_ = 10;\n\n\n/**\n * Default background color\n * @const\n * @private\n */\nInfoBubble.prototype.BACKGROUND_COLOR_ = '#fff';\n\n/**\n * Default close image source\n * @const\n * @private\n */\nInfoBubble.prototype.CLOSE_SRC_ = 'https://maps.gstatic.com/intl/en_us/mapfiles/iw_close.gif';\n\n/**\n * Extends a objects prototype by anothers.\n *\n * @param {Object} obj1 The object to be extended.\n * @param {Object} obj2 The object to extend with.\n * @return {Object} The new extended object.\n * @ignore\n */\nInfoBubble.prototype.extend = function(obj1, obj2) {\n  return (function(object) {\n    for (var property in object.prototype) {\n      this.prototype[property] = object.prototype[property];\n    }\n    return this;\n  }).apply(obj1, [obj2]);\n};\n\n\n/**\n * Builds the InfoBubble dom\n * @private\n */\nInfoBubble.prototype.buildDom_ = function() {\n  var bubble = this.bubble_ = document.createElement('DIV');\n  bubble.style['position'] = 'absolute';\n  bubble.style['zIndex'] = this.baseZIndex_;\n\n  var tabsContainer = this.tabsContainer_ = document.createElement('DIV');\n  tabsContainer.style['position'] = 'relative';\n\n  // Close button\n  var close = this.close_ = document.createElement('IMG');\n  close.style['position'] = 'absolute';\n  close.style['border'] = 0;\n  close.style['zIndex'] = this.baseZIndex_ + 1;\n  close.style['cursor'] = 'pointer';\n  close.className = 'js-info-bubble-close';\n  close.src = this.get('closeSrc');\n\n  var that = this;\n  google.maps.event.addDomListener(close, 'click', function() {\n    that.close();\n    google.maps.event.trigger(that, 'closeclick');\n  });\n\n  // Content area\n  var contentContainer = this.contentContainer_ = document.createElement('DIV');\n  contentContainer.style['overflowX'] = 'auto';\n  contentContainer.style['overflowY'] = 'auto';\n  contentContainer.style['cursor'] = 'default';\n  contentContainer.style['clear'] = 'both';\n  contentContainer.style['position'] = 'relative';\n\n  var content = this.content_ = document.createElement('DIV');\n  contentContainer.appendChild(content);\n\n  // Arrow\n  var arrow = this.arrow_ = document.createElement('DIV');\n  arrow.style['position'] = 'relative';\n\n  var arrowOuter = this.arrowOuter_ = document.createElement('DIV');\n  var arrowInner = this.arrowInner_ = document.createElement('DIV');\n\n  var arrowSize = this.getArrowSize_();\n\n  arrowOuter.style['position'] = arrowInner.style['position'] = 'absolute';\n  arrowOuter.style['left'] = arrowInner.style['left'] = '50%';\n  arrowOuter.style['height'] = arrowInner.style['height'] = '0';\n  arrowOuter.style['width'] = arrowInner.style['width'] = '0';\n  arrowOuter.style['marginLeft'] = this.px(-arrowSize);\n  arrowOuter.style['borderWidth'] = this.px(arrowSize);\n  arrowOuter.style['borderBottomWidth'] = 0;\n\n  // Shadow\n  var bubbleShadow = this.bubbleShadow_ = document.createElement('DIV');\n  bubbleShadow.style['position'] = 'absolute';\n\n  // Hide the InfoBubble by default\n  bubble.style['display'] = bubbleShadow.style['display'] = 'none';\n\n  bubble.appendChild(this.tabsContainer_);\n  bubble.appendChild(close);\n  bubble.appendChild(contentContainer);\n  arrow.appendChild(arrowOuter);\n  arrow.appendChild(arrowInner);\n  bubble.appendChild(arrow);\n\n  var stylesheet = document.createElement('style');\n  stylesheet.setAttribute('type', 'text/css');\n\n  /**\n   * The animation for the infobubble\n   * @type {string}\n   */\n  this.animationName_ = '_ibani_' + Math.round(Math.random() * 10000);\n\n  var css = '.' + this.animationName_ + '{-webkit-animation-name:' +\n      this.animationName_ + ';-webkit-animation-duration:0.5s;' +\n      '-webkit-animation-iteration-count:1;}' +\n      '@-webkit-keyframes ' + this.animationName_ + ' {from {' +\n      '-webkit-transform: scale(0)}50% {-webkit-transform: scale(1.2)}90% ' +\n      '{-webkit-transform: scale(0.95)}to {-webkit-transform: scale(1)}}';\n\n  stylesheet.textContent = css;\n  document.getElementsByTagName('head')[0].appendChild(stylesheet);\n};\n\n\n/**\n * Sets the background class name\n *\n * @param {string} className The class name to set.\n */\nInfoBubble.prototype.setBackgroundClassName = function(className) {\n  this.set('backgroundClassName', className);\n};\nInfoBubble.prototype['setBackgroundClassName'] = InfoBubble.prototype.setBackgroundClassName;\n\n\n/**\n * changed MVC callback\n */\nInfoBubble.prototype.backgroundClassName_changed = function() {\n  this.content_.className = this.get('backgroundClassName');\n};\nInfoBubble.prototype['backgroundClassName_changed'] = InfoBubble.prototype.backgroundClassName_changed;\n\n\n/**\n * Sets the class of the tab\n *\n * @param {string} className the class name to set.\n */\nInfoBubble.prototype.setTabClassName = function(className) {\n  this.set('tabClassName', className);\n};\nInfoBubble.prototype['setTabClassName'] = InfoBubble.prototype.setTabClassName;\n\n\n/**\n * tabClassName changed MVC callback\n */\nInfoBubble.prototype.tabClassName_changed = function() {\n  this.updateTabStyles_();\n};\nInfoBubble.prototype['tabClassName_changed'] = InfoBubble.prototype.tabClassName_changed;\n\n\n/**\n * Gets the style of the arrow\n *\n * @private\n * @return {number} The style of the arrow.\n */\nInfoBubble.prototype.getArrowStyle_ = function() {\n  return parseInt(this.get('arrowStyle'), 10) || 0;\n};\n\n\n/**\n * Sets the style of the arrow\n *\n * @param {number} style The style of the arrow.\n */\nInfoBubble.prototype.setArrowStyle = function(style) {\n  this.set('arrowStyle', style);\n};\nInfoBubble.prototype['setArrowStyle'] = InfoBubble.prototype.setArrowStyle;\n\n\n/**\n * Arrow style changed MVC callback\n */\nInfoBubble.prototype.arrowStyle_changed = function() {\n  this.arrowSize_changed();\n};\nInfoBubble.prototype['arrowStyle_changed'] = InfoBubble.prototype.arrowStyle_changed;\n\n\n/**\n * Gets the size of the arrow\n *\n * @private\n * @return {number} The size of the arrow.\n */\nInfoBubble.prototype.getArrowSize_ = function() {\n  return parseInt(this.get('arrowSize'), 10) || 0;\n};\n\n\n/**\n * Sets the size of the arrow\n *\n * @param {number} size The size of the arrow.\n */\nInfoBubble.prototype.setArrowSize = function(size) {\n  this.set('arrowSize', size);\n};\nInfoBubble.prototype['setArrowSize'] = InfoBubble.prototype.setArrowSize;\n\n\n/**\n * Arrow size changed MVC callback\n */\nInfoBubble.prototype.arrowSize_changed = function() {\n  this.borderWidth_changed();\n};\nInfoBubble.prototype['arrowSize_changed'] = InfoBubble.prototype.arrowSize_changed;\n\n\n/**\n * Set the position of the InfoBubble arrow\n *\n * @param {number} pos The position to set.\n */\nInfoBubble.prototype.setArrowPosition = function(pos) {\n  this.set('arrowPosition', pos);\n};\nInfoBubble.prototype['setArrowPosition'] = InfoBubble.prototype.setArrowPosition;\n\n\n/**\n * Get the position of the InfoBubble arrow\n *\n * @private\n * @return {number} The position..\n */\nInfoBubble.prototype.getArrowPosition_ = function() {\n  return parseInt(this.get('arrowPosition'), 10) || 0;\n};\n\n\n/**\n * arrowPosition changed MVC callback\n */\nInfoBubble.prototype.arrowPosition_changed = function() {\n  var pos = this.getArrowPosition_();\n  this.arrowOuter_.style['left'] = this.arrowInner_.style['left'] = pos + '%';\n\n  this.redraw_();\n};\nInfoBubble.prototype['arrowPosition_changed'] = InfoBubble.prototype.arrowPosition_changed;\n\n\n/**\n * Set the zIndex of the InfoBubble\n *\n * @param {number} zIndex The zIndex to set.\n */\nInfoBubble.prototype.setZIndex = function(zIndex) {\n  this.set('zIndex', zIndex);\n};\nInfoBubble.prototype['setZIndex'] = InfoBubble.prototype.setZIndex;\n\n\n/**\n * Get the zIndex of the InfoBubble\n *\n * @return {number} The zIndex to set.\n */\nInfoBubble.prototype.getZIndex = function() {\n  return parseInt(this.get('zIndex'), 10) || this.baseZIndex_;\n};\n\n\n/**\n * zIndex changed MVC callback\n */\nInfoBubble.prototype.zIndex_changed = function() {\n  var zIndex = this.getZIndex();\n\n  this.bubble_.style['zIndex'] = this.baseZIndex_ = zIndex;\n  this.close_.style['zIndex'] = zIndex + 1;\n};\nInfoBubble.prototype['zIndex_changed'] = InfoBubble.prototype.zIndex_changed;\n\n\n/**\n * Set the style of the shadow\n *\n * @param {number} shadowStyle The style of the shadow.\n */\nInfoBubble.prototype.setShadowStyle = function(shadowStyle) {\n  this.set('shadowStyle', shadowStyle);\n};\nInfoBubble.prototype['setShadowStyle'] = InfoBubble.prototype.setShadowStyle;\n\n\n/**\n * Get the style of the shadow\n *\n * @private\n * @return {number} The style of the shadow.\n */\nInfoBubble.prototype.getShadowStyle_ = function() {\n  return parseInt(this.get('shadowStyle'), 10) || 0;\n};\n\n\n/**\n * shadowStyle changed MVC callback\n */\nInfoBubble.prototype.shadowStyle_changed = function() {\n  var shadowStyle = this.getShadowStyle_();\n\n  var display = '';\n  var shadow = '';\n  var backgroundColor = '';\n  switch (shadowStyle) {\n    case 0:\n      display = 'none';\n      break;\n    case 1:\n      shadow = '40px 15px 10px rgba(33,33,33,0.3)';\n      backgroundColor = 'transparent';\n      break;\n    case 2:\n      shadow = '0 0 2px rgba(33,33,33,0.3)';\n      backgroundColor = 'rgba(33,33,33,0.35)';\n      break;\n  }\n  this.bubbleShadow_.style['boxShadow'] =\n      this.bubbleShadow_.style['webkitBoxShadow'] =\n      this.bubbleShadow_.style['MozBoxShadow'] = shadow;\n  this.bubbleShadow_.style['backgroundColor'] = backgroundColor;\n  if (this.isOpen_) {\n    this.bubbleShadow_.style['display'] = display;\n    this.draw();\n  }\n};\nInfoBubble.prototype['shadowStyle_changed'] = InfoBubble.prototype.shadowStyle_changed;\n\n\n/**\n * Show the close button\n */\nInfoBubble.prototype.showCloseButton = function() {\n  this.set('hideCloseButton', false);\n};\nInfoBubble.prototype['showCloseButton'] = InfoBubble.prototype.showCloseButton;\n\n\n/**\n * Hide the close button\n */\nInfoBubble.prototype.hideCloseButton = function() {\n  this.set('hideCloseButton', true);\n};\nInfoBubble.prototype['hideCloseButton'] = InfoBubble.prototype.hideCloseButton;\n\n\n/**\n * hideCloseButton changed MVC callback\n */\nInfoBubble.prototype.hideCloseButton_changed = function() {\n  this.close_.style['display'] = this.get('hideCloseButton') ? 'none' : '';\n};\nInfoBubble.prototype['hideCloseButton_changed'] = InfoBubble.prototype.hideCloseButton_changed;\n\n\n/**\n * Set the background color\n *\n * @param {string} color The color to set.\n */\nInfoBubble.prototype.setBackgroundColor = function(color) {\n  if (color) {\n    this.set('backgroundColor', color);\n  }\n};\nInfoBubble.prototype['setBackgroundColor'] = InfoBubble.prototype.setBackgroundColor;\n\n\n/**\n * backgroundColor changed MVC callback\n */\nInfoBubble.prototype.backgroundColor_changed = function() {\n  var backgroundColor = this.get('backgroundColor');\n  this.contentContainer_.style['backgroundColor'] = backgroundColor;\n\n  this.arrowInner_.style['borderColor'] = backgroundColor +\n      ' transparent transparent';\n  this.updateTabStyles_();\n};\nInfoBubble.prototype['backgroundColor_changed'] = InfoBubble.prototype.backgroundColor_changed;\n\n\n/**\n * Set the border color\n *\n * @param {string} color The border color.\n */\nInfoBubble.prototype.setBorderColor = function(color) {\n  if (color) {\n    this.set('borderColor', color);\n  }\n};\nInfoBubble.prototype['setBorderColor'] = InfoBubble.prototype.setBorderColor;\n\n\n/**\n * borderColor changed MVC callback\n */\nInfoBubble.prototype.borderColor_changed = function() {\n  var borderColor = this.get('borderColor');\n\n  var contentContainer = this.contentContainer_;\n  var arrowOuter = this.arrowOuter_;\n  contentContainer.style['borderColor'] = borderColor;\n\n  arrowOuter.style['borderColor'] = borderColor +\n      ' transparent transparent';\n\n  contentContainer.style['borderStyle'] =\n      arrowOuter.style['borderStyle'] =\n      this.arrowInner_.style['borderStyle'] = 'solid';\n\n  this.updateTabStyles_();\n};\nInfoBubble.prototype['borderColor_changed'] = InfoBubble.prototype.borderColor_changed;\n\n\n/**\n * Set the radius of the border\n *\n * @param {number} radius The radius of the border.\n */\nInfoBubble.prototype.setBorderRadius = function(radius) {\n  this.set('borderRadius', radius);\n};\nInfoBubble.prototype['setBorderRadius'] = InfoBubble.prototype.setBorderRadius;\n\n\n/**\n * Get the radius of the border\n *\n * @private\n * @return {number} The radius of the border.\n */\nInfoBubble.prototype.getBorderRadius_ = function() {\n  return parseInt(this.get('borderRadius'), 10) || 0;\n};\n\n\n/**\n * borderRadius changed MVC callback\n */\nInfoBubble.prototype.borderRadius_changed = function() {\n  var borderRadius = this.getBorderRadius_();\n  var borderWidth = this.getBorderWidth_();\n\n  this.contentContainer_.style['borderRadius'] =\n      this.contentContainer_.style['MozBorderRadius'] =\n      this.contentContainer_.style['webkitBorderRadius'] =\n      this.bubbleShadow_.style['borderRadius'] =\n      this.bubbleShadow_.style['MozBorderRadius'] =\n      this.bubbleShadow_.style['webkitBorderRadius'] = this.px(borderRadius);\n\n  this.tabsContainer_.style['paddingLeft'] =\n      this.tabsContainer_.style['paddingRight'] =\n      this.px(borderRadius + borderWidth);\n\n  this.redraw_();\n};\nInfoBubble.prototype['borderRadius_changed'] = InfoBubble.prototype.borderRadius_changed;\n\n\n/**\n * Get the width of the border\n *\n * @private\n * @return {number} width The width of the border.\n */\nInfoBubble.prototype.getBorderWidth_ = function() {\n  return parseInt(this.get('borderWidth'), 10) || 0;\n};\n\n\n/**\n * Set the width of the border\n *\n * @param {number} width The width of the border.\n */\nInfoBubble.prototype.setBorderWidth = function(width) {\n  this.set('borderWidth', width);\n};\nInfoBubble.prototype['setBorderWidth'] = InfoBubble.prototype.setBorderWidth;\n\n\n/**\n * borderWidth change MVC callback\n */\nInfoBubble.prototype.borderWidth_changed = function() {\n  var borderWidth = this.getBorderWidth_();\n\n  this.contentContainer_.style['borderWidth'] = this.px(borderWidth);\n  this.tabsContainer_.style['top'] = this.px(borderWidth);\n\n  this.updateArrowStyle_();\n  this.updateTabStyles_();\n  this.borderRadius_changed();\n  this.redraw_();\n};\nInfoBubble.prototype['borderWidth_changed'] = InfoBubble.prototype.borderWidth_changed;\n\n\n/**\n * Update the arrow style\n * @private\n */\nInfoBubble.prototype.updateArrowStyle_ = function() {\n  var borderWidth = this.getBorderWidth_();\n  var arrowSize = this.getArrowSize_();\n  var arrowStyle = this.getArrowStyle_();\n  var arrowOuterSizePx = this.px(arrowSize);\n  var arrowInnerSizePx = this.px(Math.max(0, arrowSize - borderWidth));\n\n  var outer = this.arrowOuter_;\n  var inner = this.arrowInner_;\n\n  this.arrow_.style['marginTop'] = this.px(-borderWidth);\n  outer.style['borderTopWidth'] = arrowOuterSizePx;\n  inner.style['borderTopWidth'] = arrowInnerSizePx;\n\n  // Full arrow or arrow pointing to the left\n  if (arrowStyle == 0 || arrowStyle == 1) {\n    outer.style['borderLeftWidth'] = arrowOuterSizePx;\n    inner.style['borderLeftWidth'] = arrowInnerSizePx;\n  } else {\n    outer.style['borderLeftWidth'] = inner.style['borderLeftWidth'] = 0;\n  }\n\n  // Full arrow or arrow pointing to the right\n  if (arrowStyle == 0 || arrowStyle == 2) {\n    outer.style['borderRightWidth'] = arrowOuterSizePx;\n    inner.style['borderRightWidth'] = arrowInnerSizePx;\n  } else {\n    outer.style['borderRightWidth'] = inner.style['borderRightWidth'] = 0;\n  }\n\n  if (arrowStyle < 2) {\n    outer.style['marginLeft'] = this.px(-(arrowSize));\n    inner.style['marginLeft'] = this.px(-(arrowSize - borderWidth));\n  } else {\n    outer.style['marginLeft'] = inner.style['marginLeft'] = 0;\n  }\n\n  // If there is no border then don't show thw outer arrow\n  if (borderWidth == 0) {\n    outer.style['display'] = 'none';\n  } else {\n    outer.style['display'] = '';\n  }\n};\n\n\n/**\n * Set the padding of the InfoBubble\n *\n * @param {number} padding The padding to apply.\n */\nInfoBubble.prototype.setPadding = function(padding) {\n  this.set('padding', padding);\n};\nInfoBubble.prototype['setPadding'] = InfoBubble.prototype.setPadding;\n\n\n/**\n * Set the close image url\n *\n * @param {string} src The url of the image used as a close icon\n */\nInfoBubble.prototype.setCloseSrc = function(src) {\n  if (src && this.close_) {\n    this.close_.src = src;\n  }\n};\nInfoBubble.prototype['setCloseSrc'] = InfoBubble.prototype.setCloseSrc;\n\n\n/**\n * Set the padding of the InfoBubble\n *\n * @private\n * @return {number} padding The padding to apply.\n */\nInfoBubble.prototype.getPadding_ = function() {\n  return parseInt(this.get('padding'), 10) || 0;\n};\n\n\n/**\n * padding changed MVC callback\n */\nInfoBubble.prototype.padding_changed = function() {\n  var padding = this.getPadding_();\n  this.contentContainer_.style['padding'] = this.px(padding);\n  this.updateTabStyles_();\n\n  this.redraw_();\n};\nInfoBubble.prototype['padding_changed'] = InfoBubble.prototype.padding_changed;\n\n\n/**\n * Add px extention to the number\n *\n * @param {number} num The number to wrap.\n * @return {string|number} A wrapped number.\n */\nInfoBubble.prototype.px = function(num) {\n  if (num) {\n    // 0 doesn't need to be wrapped\n    return num + 'px';\n  }\n  return num;\n};\n\n\n/**\n * Add events to stop propagation\n * @private\n */\nInfoBubble.prototype.addEvents_ = function() {\n  // We want to cancel all the events so they do not go to the map\n  var events = ['mousedown', 'mousemove', 'mouseover', 'mouseout', 'mouseup',\n      'mousewheel', 'DOMMouseScroll', 'touchstart', 'touchend', 'touchmove',\n      'dblclick', 'contextmenu', 'click'];\n\n  var bubble = this.bubble_;\n  this.listeners_ = [];\n  for (var i = 0, event; event = events[i]; i++) {\n    this.listeners_.push(\n      google.maps.event.addDomListener(bubble, event, function(e) {\n        e.cancelBubble = true;\n        if (e.stopPropagation) {\n          e.stopPropagation();\n        }\n      })\n    );\n  }\n};\n\n\n/**\n * On Adding the InfoBubble to a map\n * Implementing the OverlayView interface\n */\nInfoBubble.prototype.onAdd = function() {\n  if (!this.bubble_) {\n    this.buildDom_();\n  }\n\n  this.addEvents_();\n\n  var panes = this.getPanes();\n  if (panes) {\n    panes.floatPane.appendChild(this.bubble_);\n    panes.floatShadow.appendChild(this.bubbleShadow_);\n  }\n\n  /* once the infoBubble has been added to the DOM, fire 'domready' event */\n  google.maps.event.trigger(this, 'domready');\n};\nInfoBubble.prototype['onAdd'] = InfoBubble.prototype.onAdd;\n\n\n/**\n * Draw the InfoBubble\n * Implementing the OverlayView interface\n */\nInfoBubble.prototype.draw = function() {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  var latLng = /** @type {google.maps.LatLng} */ (this.get('position'));\n\n  if (!latLng) {\n    this.close();\n    return;\n  }\n\n  var tabHeight = 0;\n\n  if (this.activeTab_) {\n    tabHeight = this.activeTab_.offsetHeight;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var arrowSize = this.getArrowSize_();\n  var arrowPosition = this.getArrowPosition_();\n\n  arrowPosition = arrowPosition / 100;\n\n  var pos = projection.fromLatLngToDivPixel(latLng);\n  var width = this.contentContainer_.offsetWidth;\n  var height = this.bubble_.offsetHeight;\n\n  if (!width) {\n    return;\n  }\n\n  // Adjust for the height of the info bubble\n  var top = pos.y - (height + arrowSize);\n\n  if (anchorHeight) {\n    // If there is an anchor then include the height\n    top -= anchorHeight;\n  }\n\n  var left = pos.x - (width * arrowPosition);\n\n  this.bubble_.style['top'] = this.px(top);\n  this.bubble_.style['left'] = this.px(left);\n\n  var shadowStyle = parseInt(this.get('shadowStyle'), 10);\n\n  switch (shadowStyle) {\n    case 1:\n      // Shadow is behind\n      this.bubbleShadow_.style['top'] = this.px(top + tabHeight - 1);\n      this.bubbleShadow_.style['left'] = this.px(left);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] =\n          this.px(this.contentContainer_.offsetHeight - arrowSize);\n      break;\n    case 2:\n      // Shadow is below\n      width = width * 0.8;\n      if (anchorHeight) {\n        this.bubbleShadow_.style['top'] = this.px(pos.y);\n      } else {\n        this.bubbleShadow_.style['top'] = this.px(pos.y + arrowSize);\n      }\n      this.bubbleShadow_.style['left'] = this.px(pos.x - width * arrowPosition);\n\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(2);\n      break;\n  }\n};\nInfoBubble.prototype['draw'] = InfoBubble.prototype.draw;\n\n\n/**\n * Removing the InfoBubble from a map\n */\nInfoBubble.prototype.onRemove = function() {\n  if (this.bubble_ && this.bubble_.parentNode) {\n    this.bubble_.parentNode.removeChild(this.bubble_);\n  }\n  if (this.bubbleShadow_ && this.bubbleShadow_.parentNode) {\n    this.bubbleShadow_.parentNode.removeChild(this.bubbleShadow_);\n  }\n\n  for (var i = 0, listener; listener = this.listeners_[i]; i++) {\n    google.maps.event.removeListener(listener);\n  }\n};\nInfoBubble.prototype['onRemove'] = InfoBubble.prototype.onRemove;\n\n\n/**\n * Is the InfoBubble open\n *\n * @return {boolean} If the InfoBubble is open.\n */\nInfoBubble.prototype.isOpen = function() {\n  return this.isOpen_;\n};\nInfoBubble.prototype['isOpen'] = InfoBubble.prototype.isOpen;\n\n\n/**\n * Close the InfoBubble\n */\nInfoBubble.prototype.close = function() {\n  if (this.bubble_) {\n    this.bubble_.style['display'] = 'none';\n    // Remove the animation so we next time it opens it will animate again\n    this.bubble_.className =\n        this.bubble_.className.replace(this.animationName_, '');\n  }\n\n  if (this.bubbleShadow_) {\n    this.bubbleShadow_.style['display'] = 'none';\n    this.bubbleShadow_.className =\n        this.bubbleShadow_.className.replace(this.animationName_, '');\n  }\n  this.isOpen_ = false;\n};\nInfoBubble.prototype['close'] = InfoBubble.prototype.close;\n\n\n/**\n * Open the InfoBubble (asynchronous).\n *\n * @param {google.maps.Map=} opt_map Optional map to open on.\n * @param {google.maps.MVCObject=} opt_anchor Optional anchor to position at.\n */\nInfoBubble.prototype.open = function(opt_map, opt_anchor) {\n  var that = this;\n  window.setTimeout(function() {\n    that.open_(opt_map, opt_anchor);\n  }, 0);\n};\n\n\n/**\n * Open the InfoBubble\n * @private\n * @param {google.maps.Map=} opt_map Optional map to open on.\n * @param {google.maps.MVCObject=} opt_anchor Optional anchor to position at.\n */\nInfoBubble.prototype.open_ = function(opt_map, opt_anchor) {\n  this.updateContent_();\n\n  if (opt_map) {\n    this.setMap(opt_map);\n  }\n\n  if (opt_anchor) {\n    this.set('anchor', opt_anchor);\n    this.bindTo('anchorPoint', opt_anchor);\n    this.bindTo('position', opt_anchor);\n  }\n\n  // Show the bubble and the show\n  this.bubble_.style['display'] = this.bubbleShadow_.style['display'] = '';\n  var animation = !this.get('disableAnimation');\n\n  if (animation) {\n    // Add the animation\n    this.bubble_.className += ' ' + this.animationName_;\n    this.bubbleShadow_.className += ' ' + this.animationName_;\n  }\n\n  this.redraw_();\n  this.isOpen_ = true;\n\n  var pan = !this.get('disableAutoPan');\n  if (pan) {\n    var that = this;\n    window.setTimeout(function() {\n      // Pan into view, done in a time out to make it feel nicer :)\n      that.panToView();\n    }, 200);\n  }\n};\nInfoBubble.prototype['open'] = InfoBubble.prototype.open;\n\n\n/**\n * Set the position of the InfoBubble\n *\n * @param {google.maps.LatLng} position The position to set.\n */\nInfoBubble.prototype.setPosition = function(position) {\n  if (position) {\n    this.set('position', position);\n  }\n};\nInfoBubble.prototype['setPosition'] = InfoBubble.prototype.setPosition;\n\n\n/**\n * Returns the position of the InfoBubble\n *\n * @return {google.maps.LatLng} the position.\n */\nInfoBubble.prototype.getPosition = function() {\n  return /** @type {google.maps.LatLng} */ (this.get('position'));\n};\nInfoBubble.prototype['getPosition'] = InfoBubble.prototype.getPosition;\n\n\n/**\n * position changed MVC callback\n */\nInfoBubble.prototype.position_changed = function() {\n  this.draw();\n};\nInfoBubble.prototype['position_changed'] = InfoBubble.prototype.position_changed;\n\n\n/**\n * Pan the InfoBubble into view\n */\nInfoBubble.prototype.panToView = function() {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  if (!this.bubble_) {\n    // No Bubble yet so do nothing\n    return;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var height = this.bubble_.offsetHeight + anchorHeight;\n  var map = this.get('map');\n  var mapDiv = map.getDiv();\n  var mapHeight = mapDiv.offsetHeight;\n\n  var latLng = this.getPosition();\n  var centerPos = projection.fromLatLngToContainerPixel(map.getCenter());\n  var pos = projection.fromLatLngToContainerPixel(latLng);\n\n  // Find out how much space at the top is free\n  var spaceTop = centerPos.y - height;\n\n  // Fine out how much space at the bottom is free\n  var spaceBottom = mapHeight - centerPos.y;\n\n  var needsTop = spaceTop < 0;\n  var deltaY = 0;\n\n  if (needsTop) {\n    spaceTop *= -1;\n    deltaY = (spaceTop + spaceBottom) / 2;\n  }\n\n  pos.y -= deltaY;\n  latLng = projection.fromContainerPixelToLatLng(pos);\n\n  if (map.getCenter() != latLng) {\n    map.panTo(latLng);\n  }\n};\nInfoBubble.prototype['panToView'] = InfoBubble.prototype.panToView;\n\n\n/**\n * Converts a HTML string to a document fragment.\n *\n * @param {string} htmlString The HTML string to convert.\n * @return {Node} A HTML document fragment.\n * @private\n */\nInfoBubble.prototype.htmlToDocumentFragment_ = function(htmlString) {\n  htmlString = htmlString.replace(/^\\s*([\\S\\s]*)\\b\\s*$/, '$1');\n  var tempDiv = document.createElement('DIV');\n  tempDiv.innerHTML = htmlString;\n  if (tempDiv.childNodes.length == 1) {\n    return /** @type {!Node} */ (tempDiv.removeChild(tempDiv.firstChild));\n  } else {\n    var fragment = document.createDocumentFragment();\n    while (tempDiv.firstChild) {\n      fragment.appendChild(tempDiv.firstChild);\n    }\n    return fragment;\n  }\n};\n\n\n/**\n * Removes all children from the node.\n *\n * @param {Node} node The node to remove all children from.\n * @private\n */\nInfoBubble.prototype.removeChildren_ = function(node) {\n  if (!node) {\n    return;\n  }\n\n  var child;\n  while (child = node.firstChild) {\n    node.removeChild(child);\n  }\n};\n\n\n/**\n * Sets the content of the infobubble.\n *\n * @param {string|Node} content The content to set.\n */\nInfoBubble.prototype.setContent = function(content) {\n  this.set('content', content);\n};\nInfoBubble.prototype['setContent'] = InfoBubble.prototype.setContent;\n\n\n/**\n * Get the content of the infobubble.\n *\n * @return {string|Node} The marker content.\n */\nInfoBubble.prototype.getContent = function() {\n  return /** @type {Node|string} */ (this.get('content'));\n};\nInfoBubble.prototype['getContent'] = InfoBubble.prototype.getContent;\n\n\n/**\n * Sets the marker content and adds loading events to images\n */\nInfoBubble.prototype.updateContent_ = function() {\n  if (!this.content_) {\n    // The Content area doesnt exist.\n    return;\n  }\n\n  this.removeChildren_(this.content_);\n  var content = this.getContent();\n  if (content) {\n    if (typeof content == 'string') {\n      content = this.htmlToDocumentFragment_(content);\n    }\n    this.content_.appendChild(content);\n\n    var that = this;\n    var images = this.content_.getElementsByTagName('IMG');\n    for (var i = 0, image; image = images[i]; i++) {\n      // Because we don't know the size of an image till it loads, add a\n      // listener to the image load so the marker can resize and reposition\n      // itself to be the correct height.\n      google.maps.event.addDomListener(image, 'load', function() {\n        that.imageLoaded_();\n      });\n    }\n  }\n  this.redraw_();\n};\n\n\n/**\n * Image loaded\n * @private\n */\nInfoBubble.prototype.imageLoaded_ = function() {\n  var pan = !this.get('disableAutoPan');\n  this.redraw_();\n  if (pan && (this.tabs_.length == 0 || this.activeTab_.index == 0)) {\n    this.panToView();\n  }\n};\n\n\n/**\n * Updates the styles of the tabs\n * @private\n */\nInfoBubble.prototype.updateTabStyles_ = function() {\n  if (this.tabs_ && this.tabs_.length) {\n    for (var i = 0, tab; tab = this.tabs_[i]; i++) {\n      this.setTabStyle_(tab.tab);\n    }\n    this.activeTab_.style['zIndex'] = this.baseZIndex_;\n    var borderWidth = this.getBorderWidth_();\n    var padding = this.getPadding_() / 2;\n    this.activeTab_.style['borderBottomWidth'] = 0;\n    this.activeTab_.style['paddingBottom'] = this.px(padding + borderWidth);\n  }\n};\n\n\n/**\n * Sets the style of a tab\n * @private\n * @param {Element} tab The tab to style.\n */\nInfoBubble.prototype.setTabStyle_ = function(tab) {\n  var backgroundColor = this.get('backgroundColor');\n  var borderColor = this.get('borderColor');\n  var borderRadius = this.getBorderRadius_();\n  var borderWidth = this.getBorderWidth_();\n  var padding = this.getPadding_();\n\n  var marginRight = this.px(-(Math.max(padding, borderRadius)));\n  var borderRadiusPx = this.px(borderRadius);\n\n  var index = this.baseZIndex_;\n  if (tab.index) {\n    index -= tab.index;\n  }\n\n  // The styles for the tab\n  var styles = {\n    'cssFloat': 'left',\n    'position': 'relative',\n    'cursor': 'pointer',\n    'backgroundColor': backgroundColor,\n    'border': this.px(borderWidth) + ' solid ' + borderColor,\n    'padding': this.px(padding / 2) + ' ' + this.px(padding),\n    'marginRight': marginRight,\n    'whiteSpace': 'nowrap',\n    'borderRadiusTopLeft': borderRadiusPx,\n    'MozBorderRadiusTopleft': borderRadiusPx,\n    'webkitBorderTopLeftRadius': borderRadiusPx,\n    'borderRadiusTopRight': borderRadiusPx,\n    'MozBorderRadiusTopright': borderRadiusPx,\n    'webkitBorderTopRightRadius': borderRadiusPx,\n    'zIndex': index,\n    'display': 'inline'\n  };\n\n  for (var style in styles) {\n    tab.style[style] = styles[style];\n  }\n\n  var className = this.get('tabClassName');\n  if (className != undefined) {\n    tab.className += ' ' + className;\n  }\n};\n\n\n/**\n * Add user actions to a tab\n * @private\n * @param {Object} tab The tab to add the actions to.\n */\nInfoBubble.prototype.addTabActions_ = function(tab) {\n  var that = this;\n  tab.listener_ = google.maps.event.addDomListener(tab, 'click', function() {\n    that.setTabActive_(this);\n  });\n};\n\n\n/**\n * Set a tab at a index to be active\n *\n * @param {number} index The index of the tab.\n */\nInfoBubble.prototype.setTabActive = function(index) {\n  var tab = this.tabs_[index - 1];\n\n  if (tab) {\n    this.setTabActive_(tab.tab);\n  }\n};\nInfoBubble.prototype['setTabActive'] = InfoBubble.prototype.setTabActive;\n\n\n/**\n * Set a tab to be active\n * @private\n * @param {Object} tab The tab to set active.\n */\nInfoBubble.prototype.setTabActive_ = function(tab) {\n  if (!tab) {\n    this.setContent('');\n    this.updateContent_();\n    return;\n  }\n\n  var padding = this.getPadding_() / 2;\n  var borderWidth = this.getBorderWidth_();\n\n  if (this.activeTab_) {\n    var activeTab = this.activeTab_;\n    activeTab.style['zIndex'] = this.baseZIndex_ - activeTab.index;\n    activeTab.style['paddingBottom'] = this.px(padding);\n    activeTab.style['borderBottomWidth'] = this.px(borderWidth);\n  }\n\n  tab.style['zIndex'] = this.baseZIndex_;\n  tab.style['borderBottomWidth'] = 0;\n  tab.style['marginBottomWidth'] = '-10px';\n  tab.style['paddingBottom'] = this.px(padding + borderWidth);\n\n  this.setContent(this.tabs_[tab.index].content);\n  this.updateContent_();\n\n  this.activeTab_ = tab;\n\n  this.redraw_();\n};\n\n\n/**\n * Set the max width of the InfoBubble\n *\n * @param {number} width The max width.\n */\nInfoBubble.prototype.setMaxWidth = function(width) {\n  this.set('maxWidth', width);\n};\nInfoBubble.prototype['setMaxWidth'] = InfoBubble.prototype.setMaxWidth;\n\n\n/**\n * maxWidth changed MVC callback\n */\nInfoBubble.prototype.maxWidth_changed = function() {\n  this.redraw_();\n};\nInfoBubble.prototype['maxWidth_changed'] = InfoBubble.prototype.maxWidth_changed;\n\n\n/**\n * Set the max height of the InfoBubble\n *\n * @param {number} height The max height.\n */\nInfoBubble.prototype.setMaxHeight = function(height) {\n  this.set('maxHeight', height);\n};\nInfoBubble.prototype['setMaxHeight'] = InfoBubble.prototype.setMaxHeight;\n\n\n/**\n * maxHeight changed MVC callback\n */\nInfoBubble.prototype.maxHeight_changed = function() {\n  this.redraw_();\n};\nInfoBubble.prototype['maxHeight_changed'] = InfoBubble.prototype.maxHeight_changed;\n\n\n/**\n * Set the min width of the InfoBubble\n *\n * @param {number} width The min width.\n */\nInfoBubble.prototype.setMinWidth = function(width) {\n  this.set('minWidth', width);\n};\nInfoBubble.prototype['setMinWidth'] = InfoBubble.prototype.setMinWidth;\n\n\n/**\n * minWidth changed MVC callback\n */\nInfoBubble.prototype.minWidth_changed = function() {\n  this.redraw_();\n};\nInfoBubble.prototype['minWidth_changed'] = InfoBubble.prototype.minWidth_changed;\n\n\n/**\n * Set the min height of the InfoBubble\n *\n * @param {number} height The min height.\n */\nInfoBubble.prototype.setMinHeight = function(height) {\n  this.set('minHeight', height);\n};\nInfoBubble.prototype['setMinHeight'] = InfoBubble.prototype.setMinHeight;\n\n\n/**\n * minHeight changed MVC callback\n */\nInfoBubble.prototype.minHeight_changed = function() {\n  this.redraw_();\n};\nInfoBubble.prototype['minHeight_changed'] = InfoBubble.prototype.minHeight_changed;\n\n\n/**\n * Add a tab\n *\n * @param {string} label The label of the tab.\n * @param {string|Element} content The content of the tab.\n */\nInfoBubble.prototype.addTab = function(label, content) {\n  var tab = document.createElement('DIV');\n  tab.innerHTML = label;\n\n  this.setTabStyle_(tab);\n  this.addTabActions_(tab);\n\n  this.tabsContainer_.appendChild(tab);\n\n  this.tabs_.push({\n    label: label,\n    content: content,\n    tab: tab\n  });\n\n  tab.index = this.tabs_.length - 1;\n  tab.style['zIndex'] = this.baseZIndex_ - tab.index;\n\n  if (!this.activeTab_) {\n    this.setTabActive_(tab);\n  }\n\n  tab.className = tab.className + ' ' + this.animationName_;\n\n  this.redraw_();\n};\nInfoBubble.prototype['addTab'] = InfoBubble.prototype.addTab;\n\n\n/**\n * Update a tab at a speicifc index\n *\n * @param {number} index The index of the tab.\n * @param {?string} opt_label The label to change to.\n * @param {?string} opt_content The content to update to.\n */\nInfoBubble.prototype.updateTab = function(index, opt_label, opt_content) {\n  if (!this.tabs_.length || index < 0 || index >= this.tabs_.length) {\n    return;\n  }\n\n  var tab = this.tabs_[index];\n  if (opt_label != undefined) {\n    tab.tab.innerHTML = tab.label = opt_label;\n  }\n\n  if (opt_content != undefined) {\n    tab.content = opt_content;\n  }\n\n  if (this.activeTab_ == tab.tab) {\n    this.setContent(tab.content);\n    this.updateContent_();\n  }\n  this.redraw_();\n};\nInfoBubble.prototype['updateTab'] = InfoBubble.prototype.updateTab;\n\n\n/**\n * Remove a tab at a specific index\n *\n * @param {number} index The index of the tab to remove.\n */\nInfoBubble.prototype.removeTab = function(index) {\n  if (!this.tabs_.length || index < 0 || index >= this.tabs_.length) {\n    return;\n  }\n\n  var tab = this.tabs_[index];\n  tab.tab.parentNode.removeChild(tab.tab);\n\n  google.maps.event.removeListener(tab.tab.listener_);\n\n  this.tabs_.splice(index, 1);\n\n  delete tab;\n\n  for (var i = 0, t; t = this.tabs_[i]; i++) {\n    t.tab.index = i;\n  }\n\n  if (tab.tab == this.activeTab_) {\n    // Removing the current active tab\n    if (this.tabs_[index]) {\n      // Show the tab to the right\n      this.activeTab_ = this.tabs_[index].tab;\n    } else if (this.tabs_[index - 1]) {\n      // Show a tab to the left\n      this.activeTab_ = this.tabs_[index - 1].tab;\n    } else {\n      // No tabs left to sho\n      this.activeTab_ = undefined;\n    }\n\n    this.setTabActive_(this.activeTab_);\n  }\n\n  this.redraw_();\n};\nInfoBubble.prototype['removeTab'] = InfoBubble.prototype.removeTab;\n\n\n/**\n * Get the size of an element\n * @private\n * @param {Node|string} element The element to size.\n * @param {number=} opt_maxWidth Optional max width of the element.\n * @param {number=} opt_maxHeight Optional max height of the element.\n * @return {google.maps.Size} The size of the element.\n */\nInfoBubble.prototype.getElementSize_ = function(element, opt_maxWidth,\n                                                opt_maxHeight) {\n  var sizer = document.createElement('DIV');\n  sizer.style['display'] = 'inline';\n  sizer.style['position'] = 'absolute';\n  sizer.style['visibility'] = 'hidden';\n\n  if (typeof element == 'string') {\n    sizer.innerHTML = element;\n  } else {\n    sizer.appendChild(element.cloneNode(true));\n  }\n\n  document.body.appendChild(sizer);\n  var size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight);\n\n  // If the width is bigger than the max width then set the width and size again\n  if (opt_maxWidth && size.width > opt_maxWidth) {\n    sizer.style['width'] = this.px(opt_maxWidth);\n    size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight);\n  }\n\n  // If the height is bigger than the max height then set the height and size\n  // again\n  if (opt_maxHeight && size.height > opt_maxHeight) {\n    sizer.style['height'] = this.px(opt_maxHeight);\n    size = new google.maps.Size(sizer.offsetWidth, sizer.offsetHeight);\n  }\n\n  document.body.removeChild(sizer);\n  delete sizer;\n  return size;\n};\n\n\n/**\n * Redraw the InfoBubble\n * @private\n */\nInfoBubble.prototype.redraw_ = function() {\n  this.figureOutSize_();\n  this.positionCloseButton_();\n  this.draw();\n};\n\n\n/**\n * Figure out the optimum size of the InfoBubble\n * @private\n */\nInfoBubble.prototype.figureOutSize_ = function() {\n  var map = this.get('map');\n\n  if (!map) {\n    return;\n  }\n\n  var padding = this.getPadding_();\n  var borderWidth = this.getBorderWidth_();\n  var borderRadius = this.getBorderRadius_();\n  var arrowSize = this.getArrowSize_();\n\n  var mapDiv = map.getDiv();\n  var gutter = arrowSize * 2;\n  var mapWidth = mapDiv.offsetWidth - gutter;\n  var mapHeight = mapDiv.offsetHeight - gutter - this.getAnchorHeight_();\n  var tabHeight = 0;\n  var width = /** @type {number} */ (this.get('minWidth') || 0);\n  var height = /** @type {number} */ (this.get('minHeight') || 0);\n  var maxWidth = /** @type {number} */ (this.get('maxWidth') || 0);\n  var maxHeight = /** @type {number} */ (this.get('maxHeight') || 0);\n\n  maxWidth = Math.min(mapWidth, maxWidth);\n  maxHeight = Math.min(mapHeight, maxHeight);\n\n  var tabWidth = 0;\n  if (this.tabs_.length) {\n    // If there are tabs then you need to check the size of each tab's content\n    for (var i = 0, tab; tab = this.tabs_[i]; i++) {\n      var tabSize = this.getElementSize_(tab.tab, maxWidth, maxHeight);\n      var contentSize = this.getElementSize_(tab.content, maxWidth, maxHeight);\n\n      if (width < tabSize.width) {\n        width = tabSize.width;\n      }\n\n      // Add up all the tab widths because they might end up being wider than\n      // the content\n      tabWidth += tabSize.width;\n\n      if (height < tabSize.height) {\n        height = tabSize.height;\n      }\n\n      if (tabSize.height > tabHeight) {\n        tabHeight = tabSize.height;\n      }\n\n      if (width < contentSize.width) {\n        width = contentSize.width;\n      }\n\n      if (height < contentSize.height) {\n        height = contentSize.height;\n      }\n    }\n  } else {\n    var content = /** @type {string|Node} */ (this.get('content'));\n    if (typeof content == 'string') {\n      content = this.htmlToDocumentFragment_(content);\n    }\n    if (content) {\n      var contentSize = this.getElementSize_(content, maxWidth, maxHeight);\n\n      if (width < contentSize.width) {\n        width = contentSize.width;\n      }\n\n      if (height < contentSize.height) {\n        height = contentSize.height;\n      }\n    }\n  }\n\n  if (maxWidth) {\n    width = Math.min(width, maxWidth);\n  }\n\n  if (maxHeight) {\n    height = Math.min(height, maxHeight);\n  }\n\n  width = Math.max(width, tabWidth);\n\n  if (width == tabWidth) {\n    width = width + 2 * padding;\n  }\n\n  arrowSize = arrowSize * 2;\n  width = Math.max(width, arrowSize);\n\n  // Maybe add this as a option so they can go bigger than the map if the user\n  // wants\n  if (width > mapWidth) {\n    width = mapWidth;\n  }\n\n  if (height > mapHeight) {\n    height = mapHeight - tabHeight;\n  }\n\n  if (this.tabsContainer_) {\n    this.tabHeight_ = tabHeight;\n    this.tabsContainer_.style['width'] = this.px(tabWidth);\n  }\n\n  this.contentContainer_.style['width'] = this.px(width);\n  this.contentContainer_.style['height'] = this.px(height);\n};\n\n\n/**\n *  Get the height of the anchor\n *\n *  This function is a hack for now and doesn't really work that good, need to\n *  wait for pixelBounds to be correctly exposed.\n *  @private\n *  @return {number} The height of the anchor.\n */\nInfoBubble.prototype.getAnchorHeight_ = function() {\n  var anchor = this.get('anchor');\n  if (anchor) {\n    var anchorPoint = /** @type google.maps.Point */(this.get('anchorPoint'));\n\n    if (anchorPoint) {\n      return -1 * anchorPoint.y;\n    }\n  }\n  return 0;\n};\n\nInfoBubble.prototype.anchorPoint_changed = function() {\n  this.draw();\n};\nInfoBubble.prototype['anchorPoint_changed'] = InfoBubble.prototype.anchorPoint_changed;\n\n\n/**\n * Position the close button in the right spot.\n * @private\n */\nInfoBubble.prototype.positionCloseButton_ = function() {\n  var br = this.getBorderRadius_();\n  var bw = this.getBorderWidth_();\n\n  var right = 2;\n  var top = 2;\n\n  if (this.tabs_.length && this.tabHeight_) {\n    top += this.tabHeight_;\n  }\n\n  top += bw;\n  right += bw;\n\n  var c = this.contentContainer_;\n  if (c && c.clientHeight < c.scrollHeight) {\n    // If there are scrollbars then move the cross in so it is not over\n    // scrollbar\n    right += 15;\n  }\n\n  this.close_.style['right'] = this.px(right);\n  this.close_.style['top'] = this.px(top);\n};\n/*\n * Sets InfoBubble Position\n * */\nInfoBubble.prototype.setBubbleOffset = function(xOffset, yOffset) {\n  this.bubbleOffsetX = parseInt(xOffset);\n  this.bubbleOffsetY = parseInt(yOffset);\n}\n\n\n/*\n * Gets InfoBubble Position\n * */\nInfoBubble.prototype.getBubbleOffset = function() {\n  return {\n    x: this.bubbleOffsetX || 0,\n    y: this.bubbleOffsetY || 0\n  }\n}\n\n/**\n * Draw the InfoBubble\n * Implementing the OverlayView interface\n */\nInfoBubble.prototype.draw = function() {\n  var projection = this.getProjection();\n\n  if (!projection) {\n    // The map projection is not ready yet so do nothing\n    return;\n  }\n\n  var latLng = /** @type {google.maps.LatLng} */ (this.get('position'));\n\n  if (!latLng) {\n    this.close();\n    return;\n  }\n\n  var tabHeight = 0;\n\n  if (this.activeTab_) {\n    tabHeight = this.activeTab_.offsetHeight;\n  }\n\n  var anchorHeight = this.getAnchorHeight_();\n  var arrowSize = this.getArrowSize_();\n  var arrowPosition = this.getArrowPosition_();\n\n  arrowPosition = arrowPosition / 100;\n\n  var pos = projection.fromLatLngToDivPixel(latLng);\n  var width = this.contentContainer_.offsetWidth;\n  var height = this.bubble_.offsetHeight;\n\n  if (!width) {\n    return;\n  }\n\n  // Adjust for the height of the info bubble\n  var top = pos.y - (height + arrowSize) + this.getBubbleOffset().y;\n\n  if (anchorHeight) {\n    // If there is an anchor then include the height\n    top -= anchorHeight;\n  }\n\n  var left = pos.x - (width * arrowPosition) + this.getBubbleOffset().x;\n\n  this.bubble_.style['top'] = this.px(top);\n  this.bubble_.style['left'] = this.px(left);\n\n  var shadowStyle = parseInt(this.get('shadowStyle'), 10);\n\n  switch (shadowStyle) {\n    case 1:\n      // Shadow is behind\n      this.bubbleShadow_.style['top'] = this.px(top + tabHeight - 1);\n      this.bubbleShadow_.style['left'] = this.px(left);\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] =\n        this.px(this.contentContainer_.offsetHeight - arrowSize);\n      break;\n    case 2:\n      // Shadow is below\n      width = width * 0.8;\n      if (anchorHeight) {\n        this.bubbleShadow_.style['top'] = this.px(pos.y);\n      } else {\n        this.bubbleShadow_.style['top'] = this.px(pos.y + arrowSize);\n      }\n      this.bubbleShadow_.style['left'] = this.px(pos.x - width * arrowPosition);\n\n      this.bubbleShadow_.style['width'] = this.px(width);\n      this.bubbleShadow_.style['height'] = this.px(2);\n      break;\n  }\n};\n\nmodule.exports = InfoBubble;\n"]},"metadata":{},"sourceType":"script"}