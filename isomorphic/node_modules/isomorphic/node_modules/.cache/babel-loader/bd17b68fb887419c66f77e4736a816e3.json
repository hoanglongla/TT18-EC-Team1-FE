{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _orderBy2 = require('lodash/orderBy');\n\nvar _orderBy3 = _interopRequireDefault(_orderBy2);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createConnector = require('../core/createConnector');\n\nvar _createConnector2 = _interopRequireDefault(_createConnector);\n\nvar _indexUtils = require('../core/indexUtils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar namespace = 'menu';\n\nfunction getId(props) {\n  return props.attributeName;\n}\n\nfunction getCurrentRefinement(props, searchState, context) {\n  return (0, _indexUtils.getCurrentRefinementValue)(props, searchState, context, namespace + '.' + getId(props), null, function (currentRefinement) {\n    if (currentRefinement === '') {\n      return null;\n    }\n\n    return currentRefinement;\n  });\n}\n\nfunction getValue(name, props, searchState, context) {\n  var currentRefinement = getCurrentRefinement(props, searchState, context);\n  return name === currentRefinement ? '' : name;\n}\n\nfunction getLimit(_ref) {\n  var showMore = _ref.showMore,\n      limitMin = _ref.limitMin,\n      limitMax = _ref.limitMax;\n  return showMore ? limitMax : limitMin;\n}\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var id = getId(props);\n\n  var nextValue = _defineProperty({}, id, nextRefinement ? nextRefinement : '');\n\n  var resetPage = true;\n  return (0, _indexUtils.refineValue)(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return (0, _indexUtils.cleanUpValue)(searchState, context, namespace + '.' + getId(props));\n}\n\nvar sortBy = ['count:desc', 'name:asc'];\n/**\n * connectMenu connector provides the logic to build a widget that will\n * give the user the ability to choose a single value for a specific facet.\n * @name connectMenu\n * @requirements The attribute passed to the `attributeName` prop must be present in \"attributes for faceting\"\n * on the Algolia dashboard or configured as `attributesForFaceting` via a set settings call to the Algolia API.\n * @kind connector\n * @propType {string} attributeName - the name of the attribute in the record\n * @propType {boolean} [showMore=false] - true if the component should display a button that will expand the number of items\n * @propType {number} [limitMin=10] - the minimum number of diplayed items\n * @propType {number} [limitMax=20] - the maximun number of displayed items. Only used when showMore is set to `true`\n * @propType {string} [defaultRefinement] - the value of the item selected by default\n * @propType {boolean} [withSearchBox=false] - allow search inside values\n * @providedPropType {function} refine - a function to toggle a refinement\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied\n * @providedPropType {array.<{count: number, isRefined: boolean, label: string, value: string}>} items - the list of items the Menu can display.\n * @providedPropType {function} searchForItems - a function to toggle a search inside items values\n * @providedPropType {boolean} isFromSearch - a boolean that says if the `items` props contains facet values from the global search or from the search inside items.\n */\n\nexports.default = (0, _createConnector2.default)({\n  displayName: 'AlgoliaMenu',\n  propTypes: {\n    attributeName: _propTypes2.default.string.isRequired,\n    showMore: _propTypes2.default.bool,\n    limitMin: _propTypes2.default.number,\n    limitMax: _propTypes2.default.number,\n    defaultRefinement: _propTypes2.default.string,\n    transformItems: _propTypes2.default.func,\n    withSearchBox: _propTypes2.default.bool,\n    searchForFacetValues: _propTypes2.default.bool // @deprecated\n\n  },\n  defaultProps: {\n    showMore: false,\n    limitMin: 10,\n    limitMax: 20\n  },\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults, meta, searchForFacetValuesResults) {\n    var _this = this;\n\n    var attributeName = props.attributeName;\n    var results = (0, _indexUtils.getResults)(searchResults, this.context);\n    var canRefine = Boolean(results) && Boolean(results.getFacetByName(attributeName));\n    var isFromSearch = Boolean(searchForFacetValuesResults && searchForFacetValuesResults[attributeName] && searchForFacetValuesResults.query !== '');\n    var withSearchBox = props.withSearchBox || props.searchForFacetValues;\n\n    if (process.env.NODE_ENV === 'development' && props.searchForFacetValues) {\n      // eslint-disable-next-line no-console\n      console.warn('react-instantsearch: `searchForFacetValues` has been renamed to' + '`withSearchBox`, this will break in the next major version.');\n    } // Search For Facet Values is not available with derived helper (used for multi index search)\n\n\n    if (props.withSearchBox && this.context.multiIndexContext) {\n      throw new Error('react-instantsearch: searching in *List is not available when used inside a' + ' multi index context');\n    }\n\n    if (!canRefine) {\n      return {\n        items: [],\n        currentRefinement: getCurrentRefinement(props, searchState, this.context),\n        isFromSearch: isFromSearch,\n        withSearchBox: withSearchBox,\n        canRefine: canRefine\n      };\n    }\n\n    var items = isFromSearch ? searchForFacetValuesResults[attributeName].map(function (v) {\n      return {\n        label: v.value,\n        value: getValue(v.value, props, searchState, _this.context),\n        _highlightResult: {\n          label: {\n            value: v.highlighted\n          }\n        },\n        count: v.count,\n        isRefined: v.isRefined\n      };\n    }) : results.getFacetValues(attributeName, {\n      sortBy: sortBy\n    }).map(function (v) {\n      return {\n        label: v.name,\n        value: getValue(v.name, props, searchState, _this.context),\n        count: v.count,\n        isRefined: v.isRefined\n      };\n    });\n    var sortedItems = withSearchBox && !isFromSearch ? (0, _orderBy3.default)(items, ['isRefined', 'count', 'label'], ['desc', 'desc', 'asc']) : items;\n    var transformedItems = props.transformItems ? props.transformItems(sortedItems) : sortedItems;\n    return {\n      items: transformedItems.slice(0, getLimit(props)),\n      currentRefinement: getCurrentRefinement(props, searchState, this.context),\n      isFromSearch: isFromSearch,\n      withSearchBox: withSearchBox,\n      canRefine: items.length > 0\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, this.context);\n  },\n  searchForFacetValues: function searchForFacetValues(props, searchState, nextRefinement) {\n    return {\n      facetName: props.attributeName,\n      query: nextRefinement,\n      maxFacetHits: getLimit(props)\n    };\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, this.context);\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributeName = props.attributeName;\n    searchParameters = searchParameters.setQueryParameters({\n      maxValuesPerFacet: Math.max(searchParameters.maxValuesPerFacet || 0, getLimit(props))\n    });\n    searchParameters = searchParameters.addDisjunctiveFacet(attributeName);\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n\n    if (currentRefinement !== null) {\n      searchParameters = searchParameters.addDisjunctiveFacetRefinement(attributeName, currentRefinement);\n    }\n\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var _this2 = this;\n\n    var id = getId(props);\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n    return {\n      id: id,\n      index: (0, _indexUtils.getIndex)(this.context),\n      items: currentRefinement === null ? [] : [{\n        label: props.attributeName + ': ' + currentRefinement,\n        attributeName: props.attributeName,\n        value: function value(nextState) {\n          return _refine(props, nextState, '', _this2.context);\n        },\n        currentRefinement: currentRefinement\n      }]\n    };\n  }\n});","map":{"version":3,"sources":["D:/Team6-FE/isomorphic/node_modules/react-instantsearch/src/connectors/connectMenu.js"],"names":["Object","defineProperty","exports","value","_orderBy2","require","_orderBy3","_interopRequireDefault","_propTypes","_propTypes2","_createConnector","_createConnector2","_indexUtils","obj","__esModule","default","_defineProperty","key","enumerable","configurable","writable","namespace","getId","props","attributeName","getCurrentRefinement","searchState","context","getCurrentRefinementValue","currentRefinement","getValue","name","getLimit","_ref","showMore","limitMin","limitMax","_refine","nextRefinement","id","nextValue","resetPage","refineValue","_cleanUp","cleanUpValue","sortBy","displayName","propTypes","string","isRequired","bool","number","defaultRefinement","transformItems","func","withSearchBox","searchForFacetValues","defaultProps","getProvidedProps","searchResults","meta","searchForFacetValuesResults","_this","results","getResults","canRefine","Boolean","getFacetByName","isFromSearch","query","process","env","NODE_ENV","console","warn","multiIndexContext","Error","items","map","v","label","_highlightResult","highlighted","count","isRefined","getFacetValues","sortedItems","transformedItems","slice","length","refine","facetName","maxFacetHits","cleanUp","getSearchParameters","searchParameters","setQueryParameters","maxValuesPerFacet","Math","max","addDisjunctiveFacet","addDisjunctiveFacetRefinement","getMetadata","_this2","index","getIndex","nextState"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _orderBy2 = require('lodash/orderBy');\n\nvar _orderBy3 = _interopRequireDefault(_orderBy2);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createConnector = require('../core/createConnector');\n\nvar _createConnector2 = _interopRequireDefault(_createConnector);\n\nvar _indexUtils = require('../core/indexUtils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar namespace = 'menu';\n\nfunction getId(props) {\n  return props.attributeName;\n}\n\nfunction getCurrentRefinement(props, searchState, context) {\n  return (0, _indexUtils.getCurrentRefinementValue)(props, searchState, context, namespace + '.' + getId(props), null, function (currentRefinement) {\n    if (currentRefinement === '') {\n      return null;\n    }\n    return currentRefinement;\n  });\n}\n\nfunction getValue(name, props, searchState, context) {\n  var currentRefinement = getCurrentRefinement(props, searchState, context);\n  return name === currentRefinement ? '' : name;\n}\n\nfunction getLimit(_ref) {\n  var showMore = _ref.showMore,\n      limitMin = _ref.limitMin,\n      limitMax = _ref.limitMax;\n\n  return showMore ? limitMax : limitMin;\n}\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var id = getId(props);\n  var nextValue = _defineProperty({}, id, nextRefinement ? nextRefinement : '');\n  var resetPage = true;\n  return (0, _indexUtils.refineValue)(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return (0, _indexUtils.cleanUpValue)(searchState, context, namespace + '.' + getId(props));\n}\n\nvar sortBy = ['count:desc', 'name:asc'];\n\n/**\n * connectMenu connector provides the logic to build a widget that will\n * give the user the ability to choose a single value for a specific facet.\n * @name connectMenu\n * @requirements The attribute passed to the `attributeName` prop must be present in \"attributes for faceting\"\n * on the Algolia dashboard or configured as `attributesForFaceting` via a set settings call to the Algolia API.\n * @kind connector\n * @propType {string} attributeName - the name of the attribute in the record\n * @propType {boolean} [showMore=false] - true if the component should display a button that will expand the number of items\n * @propType {number} [limitMin=10] - the minimum number of diplayed items\n * @propType {number} [limitMax=20] - the maximun number of displayed items. Only used when showMore is set to `true`\n * @propType {string} [defaultRefinement] - the value of the item selected by default\n * @propType {boolean} [withSearchBox=false] - allow search inside values\n * @providedPropType {function} refine - a function to toggle a refinement\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied\n * @providedPropType {array.<{count: number, isRefined: boolean, label: string, value: string}>} items - the list of items the Menu can display.\n * @providedPropType {function} searchForItems - a function to toggle a search inside items values\n * @providedPropType {boolean} isFromSearch - a boolean that says if the `items` props contains facet values from the global search or from the search inside items.\n */\nexports.default = (0, _createConnector2.default)({\n  displayName: 'AlgoliaMenu',\n\n  propTypes: {\n    attributeName: _propTypes2.default.string.isRequired,\n    showMore: _propTypes2.default.bool,\n    limitMin: _propTypes2.default.number,\n    limitMax: _propTypes2.default.number,\n    defaultRefinement: _propTypes2.default.string,\n    transformItems: _propTypes2.default.func,\n    withSearchBox: _propTypes2.default.bool,\n    searchForFacetValues: _propTypes2.default.bool // @deprecated\n  },\n\n  defaultProps: {\n    showMore: false,\n    limitMin: 10,\n    limitMax: 20\n  },\n\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults, meta, searchForFacetValuesResults) {\n    var _this = this;\n\n    var attributeName = props.attributeName;\n\n    var results = (0, _indexUtils.getResults)(searchResults, this.context);\n\n    var canRefine = Boolean(results) && Boolean(results.getFacetByName(attributeName));\n\n    var isFromSearch = Boolean(searchForFacetValuesResults && searchForFacetValuesResults[attributeName] && searchForFacetValuesResults.query !== '');\n    var withSearchBox = props.withSearchBox || props.searchForFacetValues;\n    if (process.env.NODE_ENV === 'development' && props.searchForFacetValues) {\n      // eslint-disable-next-line no-console\n      console.warn('react-instantsearch: `searchForFacetValues` has been renamed to' + '`withSearchBox`, this will break in the next major version.');\n    }\n    // Search For Facet Values is not available with derived helper (used for multi index search)\n    if (props.withSearchBox && this.context.multiIndexContext) {\n      throw new Error('react-instantsearch: searching in *List is not available when used inside a' + ' multi index context');\n    }\n\n    if (!canRefine) {\n      return {\n        items: [],\n        currentRefinement: getCurrentRefinement(props, searchState, this.context),\n        isFromSearch: isFromSearch,\n        withSearchBox: withSearchBox,\n        canRefine: canRefine\n      };\n    }\n\n    var items = isFromSearch ? searchForFacetValuesResults[attributeName].map(function (v) {\n      return {\n        label: v.value,\n        value: getValue(v.value, props, searchState, _this.context),\n        _highlightResult: { label: { value: v.highlighted } },\n        count: v.count,\n        isRefined: v.isRefined\n      };\n    }) : results.getFacetValues(attributeName, { sortBy: sortBy }).map(function (v) {\n      return {\n        label: v.name,\n        value: getValue(v.name, props, searchState, _this.context),\n        count: v.count,\n        isRefined: v.isRefined\n      };\n    });\n\n    var sortedItems = withSearchBox && !isFromSearch ? (0, _orderBy3.default)(items, ['isRefined', 'count', 'label'], ['desc', 'desc', 'asc']) : items;\n    var transformedItems = props.transformItems ? props.transformItems(sortedItems) : sortedItems;\n    return {\n      items: transformedItems.slice(0, getLimit(props)),\n      currentRefinement: getCurrentRefinement(props, searchState, this.context),\n      isFromSearch: isFromSearch,\n      withSearchBox: withSearchBox,\n      canRefine: items.length > 0\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, this.context);\n  },\n  searchForFacetValues: function searchForFacetValues(props, searchState, nextRefinement) {\n    return {\n      facetName: props.attributeName,\n      query: nextRefinement,\n      maxFacetHits: getLimit(props)\n    };\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, this.context);\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributeName = props.attributeName;\n\n\n    searchParameters = searchParameters.setQueryParameters({\n      maxValuesPerFacet: Math.max(searchParameters.maxValuesPerFacet || 0, getLimit(props))\n    });\n\n    searchParameters = searchParameters.addDisjunctiveFacet(attributeName);\n\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n    if (currentRefinement !== null) {\n      searchParameters = searchParameters.addDisjunctiveFacetRefinement(attributeName, currentRefinement);\n    }\n\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var _this2 = this;\n\n    var id = getId(props);\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n    return {\n      id: id,\n      index: (0, _indexUtils.getIndex)(this.context),\n      items: currentRefinement === null ? [] : [{\n        label: props.attributeName + ': ' + currentRefinement,\n        attributeName: props.attributeName,\n        value: function value(nextState) {\n          return _refine(props, nextState, '', _this2.context);\n        },\n        currentRefinement: currentRefinement\n      }]\n    };\n  }\n});"]},"metadata":{},"sourceType":"script"}