{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _isEmpty2 = require('lodash/isEmpty');\n\nvar _isEmpty3 = _interopRequireDefault(_isEmpty2);\n\nvar _find3 = require('lodash/find');\n\nvar _find4 = _interopRequireDefault(_find3);\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _indexUtils = require('../core/indexUtils');\n\nvar _createConnector = require('../core/createConnector');\n\nvar _createConnector2 = _interopRequireDefault(_createConnector);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction stringifyItem(item) {\n  if (typeof item.start === 'undefined' && typeof item.end === 'undefined') {\n    return '';\n  }\n\n  return (item.start ? item.start : '') + ':' + (item.end ? item.end : '');\n}\n\nfunction parseItem(value) {\n  if (value.length === 0) {\n    return {\n      start: null,\n      end: null\n    };\n  }\n\n  var _value$split = value.split(':'),\n      _value$split2 = _slicedToArray(_value$split, 2),\n      startStr = _value$split2[0],\n      endStr = _value$split2[1];\n\n  return {\n    start: startStr.length > 0 ? parseInt(startStr, 10) : null,\n    end: endStr.length > 0 ? parseInt(endStr, 10) : null\n  };\n}\n\nvar namespace = 'multiRange';\n\nfunction getId(props) {\n  return props.attributeName;\n}\n\nfunction getCurrentRefinement(props, searchState, context) {\n  return (0, _indexUtils.getCurrentRefinementValue)(props, searchState, context, namespace + '.' + getId(props), '', function (currentRefinement) {\n    if (currentRefinement === '') {\n      return '';\n    }\n\n    return currentRefinement;\n  });\n}\n\nfunction isRefinementsRangeIncludesInsideItemRange(stats, start, end) {\n  return stats.min > start && stats.min < end || stats.max > start && stats.max < end;\n}\n\nfunction isItemRangeIncludedInsideRefinementsRange(stats, start, end) {\n  return start > stats.min && start < stats.max || end > stats.min && end < stats.max;\n}\n\nfunction itemHasRefinement(attributeName, results, value) {\n  var stats = results.getFacetByName(attributeName) ? results.getFacetStats(attributeName) : null;\n  var range = value.split(':');\n  var start = Number(range[0]) === 0 || value === '' ? Number.NEGATIVE_INFINITY : Number(range[0]);\n  var end = Number(range[1]) === 0 || value === '' ? Number.POSITIVE_INFINITY : Number(range[1]);\n  return !(Boolean(stats) && (isRefinementsRangeIncludesInsideItemRange(stats, start, end) || isItemRangeIncludedInsideRefinementsRange(stats, start, end)));\n}\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var nextValue = _defineProperty({}, getId(props, searchState), nextRefinement);\n\n  var resetPage = true;\n  return (0, _indexUtils.refineValue)(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return (0, _indexUtils.cleanUpValue)(searchState, context, namespace + '.' + getId(props));\n}\n/**\n * connectMultiRange connector provides the logic to build a widget that will\n * give the user the ability to select a range value for a numeric attribute.\n * Ranges are defined statically.\n * @name connectMultiRange\n * @requirements The attribute passed to the `attributeName` prop must be holding numerical values.\n * @kind connector\n * @propType {string} attributeName - the name of the attribute in the records\n * @propType {{label: string, start: number, end: number}[]} items - List of options. With a text label, and upper and lower bounds.\n * @propType {string} [defaultRefinement] - the value of the item selected by default, follow the shape of a `string` with a pattern of `'{start}:{end}'`.\n * @propType {function} [transformItems] - Function to modify the items being displayed, e.g. for filtering or sorting them. Takes an items as parameter and expects it back in return.\n * @providedPropType {function} refine - a function to select a range.\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied.  follow the shape of a `string` with a pattern of `'{start}:{end}'` which corresponds to the current selected item. For instance, when the selected item is `{start: 10, end: 20}`, the searchState of the widget is `'10:20'`. When `start` isn't defined, the searchState of the widget is `':{end}'`, and the same way around when `end` isn't defined. However, when neither `start` nor `end` are defined, the searchState is an empty string.\n * @providedPropType {array.<{isRefined: boolean, label: string, value: string, isRefined: boolean, noRefinement: boolean}>} items - the list of ranges the MultiRange can display.\n */\n\n\nexports.default = (0, _createConnector2.default)({\n  displayName: 'AlgoliaMultiRange',\n  propTypes: {\n    id: _propTypes2.default.string,\n    attributeName: _propTypes2.default.string.isRequired,\n    items: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n      label: _propTypes2.default.node,\n      start: _propTypes2.default.number,\n      end: _propTypes2.default.number\n    })).isRequired,\n    transformItems: _propTypes2.default.func\n  },\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults) {\n    var attributeName = props.attributeName;\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n    var results = (0, _indexUtils.getResults)(searchResults, this.context);\n    var items = props.items.map(function (item) {\n      var value = stringifyItem(item);\n      return {\n        label: item.label,\n        value: value,\n        isRefined: value === currentRefinement,\n        noRefinement: results ? itemHasRefinement(getId(props), results, value) : false\n      };\n    });\n    var stats = results && results.getFacetByName(attributeName) ? results.getFacetStats(attributeName) : null;\n    var refinedItem = (0, _find4.default)(items, function (item) {\n      return item.isRefined === true;\n    });\n\n    if (!items.some(function (item) {\n      return item.value === '';\n    })) {\n      items.push({\n        value: '',\n        isRefined: (0, _isEmpty3.default)(refinedItem),\n        noRefinement: !stats,\n        label: 'All'\n      });\n    }\n\n    return {\n      items: props.transformItems ? props.transformItems(items) : items,\n      currentRefinement: currentRefinement,\n      canRefine: items.length > 0 && items.some(function (item) {\n        return item.noRefinement === false;\n      })\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, this.context);\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, this.context);\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributeName = props.attributeName;\n\n    var _parseItem = parseItem(getCurrentRefinement(props, searchState, this.context)),\n        start = _parseItem.start,\n        end = _parseItem.end;\n\n    searchParameters = searchParameters.addDisjunctiveFacet(attributeName);\n\n    if (start) {\n      searchParameters = searchParameters.addNumericRefinement(attributeName, '>=', start);\n    }\n\n    if (end) {\n      searchParameters = searchParameters.addNumericRefinement(attributeName, '<=', end);\n    }\n\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var _this = this;\n\n    var id = getId(props);\n    var value = getCurrentRefinement(props, searchState, this.context);\n    var items = [];\n    var index = (0, _indexUtils.getIndex)(this.context);\n\n    if (value !== '') {\n      var _find2 = (0, _find4.default)(props.items, function (item) {\n        return stringifyItem(item) === value;\n      }),\n          label = _find2.label;\n\n      items.push({\n        label: props.attributeName + ': ' + label,\n        attributeName: props.attributeName,\n        currentRefinement: label,\n        value: function value(nextState) {\n          return _refine(props, nextState, '', _this.context);\n        }\n      });\n    }\n\n    return {\n      id: id,\n      index: index,\n      items: items\n    };\n  }\n});","map":{"version":3,"sources":["D:/TT18-EC-Team1-FE/isomorphic/node_modules/react-instantsearch/src/connectors/connectMultiRange.js"],"names":["Object","defineProperty","exports","value","_isEmpty2","require","_isEmpty3","_interopRequireDefault","_find3","_find4","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","_propTypes","_propTypes2","_indexUtils","_createConnector","_createConnector2","obj","__esModule","default","_defineProperty","key","enumerable","configurable","writable","stringifyItem","item","start","end","parseItem","_value$split","split","_value$split2","startStr","endStr","parseInt","namespace","getId","props","attributeName","getCurrentRefinement","searchState","context","getCurrentRefinementValue","currentRefinement","isRefinementsRangeIncludesInsideItemRange","stats","min","max","isItemRangeIncludedInsideRefinementsRange","itemHasRefinement","results","getFacetByName","getFacetStats","range","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","Boolean","_refine","nextRefinement","nextValue","resetPage","refineValue","_cleanUp","cleanUpValue","displayName","propTypes","id","string","isRequired","items","arrayOf","shape","label","node","number","transformItems","func","getProvidedProps","searchResults","getResults","map","isRefined","noRefinement","refinedItem","some","canRefine","refine","cleanUp","getSearchParameters","searchParameters","_parseItem","addDisjunctiveFacet","addNumericRefinement","getMetadata","_this","index","getIndex","_find2","nextState"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _isEmpty2 = require('lodash/isEmpty');\n\nvar _isEmpty3 = _interopRequireDefault(_isEmpty2);\n\nvar _find3 = require('lodash/find');\n\nvar _find4 = _interopRequireDefault(_find3);\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _indexUtils = require('../core/indexUtils');\n\nvar _createConnector = require('../core/createConnector');\n\nvar _createConnector2 = _interopRequireDefault(_createConnector);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction stringifyItem(item) {\n  if (typeof item.start === 'undefined' && typeof item.end === 'undefined') {\n    return '';\n  }\n  return (item.start ? item.start : '') + ':' + (item.end ? item.end : '');\n}\n\nfunction parseItem(value) {\n  if (value.length === 0) {\n    return { start: null, end: null };\n  }\n\n  var _value$split = value.split(':'),\n      _value$split2 = _slicedToArray(_value$split, 2),\n      startStr = _value$split2[0],\n      endStr = _value$split2[1];\n\n  return {\n    start: startStr.length > 0 ? parseInt(startStr, 10) : null,\n    end: endStr.length > 0 ? parseInt(endStr, 10) : null\n  };\n}\n\nvar namespace = 'multiRange';\n\nfunction getId(props) {\n  return props.attributeName;\n}\n\nfunction getCurrentRefinement(props, searchState, context) {\n  return (0, _indexUtils.getCurrentRefinementValue)(props, searchState, context, namespace + '.' + getId(props), '', function (currentRefinement) {\n    if (currentRefinement === '') {\n      return '';\n    }\n    return currentRefinement;\n  });\n}\n\nfunction isRefinementsRangeIncludesInsideItemRange(stats, start, end) {\n  return stats.min > start && stats.min < end || stats.max > start && stats.max < end;\n}\n\nfunction isItemRangeIncludedInsideRefinementsRange(stats, start, end) {\n  return start > stats.min && start < stats.max || end > stats.min && end < stats.max;\n}\n\nfunction itemHasRefinement(attributeName, results, value) {\n  var stats = results.getFacetByName(attributeName) ? results.getFacetStats(attributeName) : null;\n  var range = value.split(':');\n  var start = Number(range[0]) === 0 || value === '' ? Number.NEGATIVE_INFINITY : Number(range[0]);\n  var end = Number(range[1]) === 0 || value === '' ? Number.POSITIVE_INFINITY : Number(range[1]);\n  return !(Boolean(stats) && (isRefinementsRangeIncludesInsideItemRange(stats, start, end) || isItemRangeIncludedInsideRefinementsRange(stats, start, end)));\n}\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var nextValue = _defineProperty({}, getId(props, searchState), nextRefinement);\n  var resetPage = true;\n  return (0, _indexUtils.refineValue)(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return (0, _indexUtils.cleanUpValue)(searchState, context, namespace + '.' + getId(props));\n}\n\n/**\n * connectMultiRange connector provides the logic to build a widget that will\n * give the user the ability to select a range value for a numeric attribute.\n * Ranges are defined statically.\n * @name connectMultiRange\n * @requirements The attribute passed to the `attributeName` prop must be holding numerical values.\n * @kind connector\n * @propType {string} attributeName - the name of the attribute in the records\n * @propType {{label: string, start: number, end: number}[]} items - List of options. With a text label, and upper and lower bounds.\n * @propType {string} [defaultRefinement] - the value of the item selected by default, follow the shape of a `string` with a pattern of `'{start}:{end}'`.\n * @propType {function} [transformItems] - Function to modify the items being displayed, e.g. for filtering or sorting them. Takes an items as parameter and expects it back in return.\n * @providedPropType {function} refine - a function to select a range.\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied.  follow the shape of a `string` with a pattern of `'{start}:{end}'` which corresponds to the current selected item. For instance, when the selected item is `{start: 10, end: 20}`, the searchState of the widget is `'10:20'`. When `start` isn't defined, the searchState of the widget is `':{end}'`, and the same way around when `end` isn't defined. However, when neither `start` nor `end` are defined, the searchState is an empty string.\n * @providedPropType {array.<{isRefined: boolean, label: string, value: string, isRefined: boolean, noRefinement: boolean}>} items - the list of ranges the MultiRange can display.\n */\nexports.default = (0, _createConnector2.default)({\n  displayName: 'AlgoliaMultiRange',\n\n  propTypes: {\n    id: _propTypes2.default.string,\n    attributeName: _propTypes2.default.string.isRequired,\n    items: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n      label: _propTypes2.default.node,\n      start: _propTypes2.default.number,\n      end: _propTypes2.default.number\n    })).isRequired,\n    transformItems: _propTypes2.default.func\n  },\n\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults) {\n    var attributeName = props.attributeName;\n    var currentRefinement = getCurrentRefinement(props, searchState, this.context);\n    var results = (0, _indexUtils.getResults)(searchResults, this.context);\n\n    var items = props.items.map(function (item) {\n      var value = stringifyItem(item);\n      return {\n        label: item.label,\n        value: value,\n        isRefined: value === currentRefinement,\n        noRefinement: results ? itemHasRefinement(getId(props), results, value) : false\n      };\n    });\n\n    var stats = results && results.getFacetByName(attributeName) ? results.getFacetStats(attributeName) : null;\n    var refinedItem = (0, _find4.default)(items, function (item) {\n      return item.isRefined === true;\n    });\n    if (!items.some(function (item) {\n      return item.value === '';\n    })) {\n      items.push({\n        value: '',\n        isRefined: (0, _isEmpty3.default)(refinedItem),\n        noRefinement: !stats,\n        label: 'All'\n      });\n    }\n\n    return {\n      items: props.transformItems ? props.transformItems(items) : items,\n      currentRefinement: currentRefinement,\n      canRefine: items.length > 0 && items.some(function (item) {\n        return item.noRefinement === false;\n      })\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, this.context);\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, this.context);\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributeName = props.attributeName;\n\n    var _parseItem = parseItem(getCurrentRefinement(props, searchState, this.context)),\n        start = _parseItem.start,\n        end = _parseItem.end;\n\n    searchParameters = searchParameters.addDisjunctiveFacet(attributeName);\n\n    if (start) {\n      searchParameters = searchParameters.addNumericRefinement(attributeName, '>=', start);\n    }\n    if (end) {\n      searchParameters = searchParameters.addNumericRefinement(attributeName, '<=', end);\n    }\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var _this = this;\n\n    var id = getId(props);\n    var value = getCurrentRefinement(props, searchState, this.context);\n    var items = [];\n    var index = (0, _indexUtils.getIndex)(this.context);\n    if (value !== '') {\n      var _find2 = (0, _find4.default)(props.items, function (item) {\n        return stringifyItem(item) === value;\n      }),\n          label = _find2.label;\n\n      items.push({\n        label: props.attributeName + ': ' + label,\n        attributeName: props.attributeName,\n        currentRefinement: label,\n        value: function value(nextState) {\n          return _refine(props, nextState, '', _this.context);\n        }\n      });\n    }\n    return { id: id, index: index, items: items };\n  }\n});"]},"metadata":{},"sourceType":"script"}